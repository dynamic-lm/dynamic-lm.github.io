<!DOCTYPE html>
<html lang="en"></html>

<head>
    <meta charset="utf-8">
    <!-- Meta tags for social media banners, these should be filled in appropriately as they are your "business card" -->
    <!-- Replace the content tag with appropriate information -->
    <meta name="description" content="Project page for the paper “Are Large Reasoning Models Interruptible?” by Tsung-Han Wu, Mihran Miroyan, David M. Chan, Trevor Darrell, Narges Norouzi, and Joseph E. Gonzalez.">
    <meta property="og:title" content="Are Large Reasoning Models Interruptible?" />
    <meta property="og:description" content="Project page for the paper “Are Large Reasoning Models Interruptible?” by Tsung-Han Wu, Mihran Miroyan, David M. Chan, Trevor Darrell, Narges Norouzi, and Joseph E. Gonzalez." />
    <meta property="og:url" content="http://reverse-vlm.github.io" />
    <!-- Path to banner image, should be in the path listed below. Optimal dimensions are 1200X630-->
    <meta property="og:image" content="static/images/ilrm_logo.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />


    <meta name="twitter:title" content="Are Large Reasoning Models Interruptible?">
    <meta name="twitter:description" content="Project page for the paper “Are Large Reasoning Models Interruptible?” by Tsung-Han Wu, Mihran Miroyan, David M. Chan, Trevor Darrell, Narges Norouzi, and Joseph E. Gonzalez." />
    <!-- Path to banner image, should be in the path listed below. Optimal dimensions are 1200X600-->
    <meta name="twitter:image" content="static/images/ilrm_logo.png">
    <meta name="twitter:card" content="IRLM Project Logo highlighting interruptible large reasoning models.">
    <!-- Keywords for your paper to be indexed by-->
    <meta name="keywords"
        content="Large Reasoning Models, Interruptibility, Large Language Models">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>Are Large Reasoning Models Interruptible?</title>
    <!-- Standard favicon (for most browsers) -->
    <link rel="icon" type="image/png" sizes="32x32" href="/static/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/images/favicon/favicon-96x96.png">
    <link rel="icon" type="image/x-icon" href="/static/images/favicon/favicon.ico">

    <!-- Apple Touch Icon (iOS / macOS Safari bookmarks) -->
    <link rel="apple-touch-icon" sizes="180x180" href="/static/images/favicon/apple-touch-icon.png">
    <!-- Progressive Web App manifest (optional) -->
    <link rel="manifest" href="/static/images/favicon/site.webmanifest">

    <link rel="stylesheet" href="static/css/bulma.min.css">
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <link rel="stylesheet" href="static/css/index.css">

    <!-- Floating TOC Styles -->
    <style>
        .floating-toc {
            position: fixed;
            left: 2%;
            top: 60%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-width: 10%;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .floating-toc:hover {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .toc-title {
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .toc-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .toc-item {
            margin-bottom: 0.5rem;
        }
        
        .toc-link {
            color: #64748b;
            text-decoration: none;
            display: block;
            padding: 0.25rem 0;
            border-radius: 6px;
            transition: all 0.2s ease;
            line-height: 1.4;
        }
        
        .toc-link:hover {
            color: #3b82f6;
            background: rgba(59, 130, 246, 0.1);
            padding-left: 0.5rem;
        }
        
        .toc-link.active {
            color: #1e293b;
            font-weight: 600;
            background: rgba(59, 130, 246, 0.15);
            padding-left: 0.5rem;
        }
        
        @media (max-width: 1200px) {
            .floating-toc {
                display: none;
            }
        }
        
        /* Interactive Examples Styles */
        .interactive-viz { margin: 0; font-family: "Inter", Arial, sans-serif; background: #eef2f7; color: #1c1c1c; }
        .interactive-viz .wrapper { max-width: 1280px; margin: 32px auto; background: #fff; border-radius: 14px; box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12); overflow: hidden; }
        .interactive-viz .header { padding: 12px 20px; background: linear-gradient(135deg, #1f3c88, #111827); color: #fff; display: flex; justify-content: space-between; align-items: center; }
        .interactive-viz .header h1 { margin: 0; font-size: 0.95rem; font-weight: 600; max-width: 75%; letter-spacing: 0.01em; }
        .interactive-viz .header h1 a {
            color: inherit;
            text-decoration: none;
            border-bottom: 1px solid rgba(255,255,255,0.35);
            transition: color 0.15s ease, border-bottom-color 0.15s ease;
        }
        .interactive-viz .header h1 a:hover {
            color: #bfdbfe;
            border-bottom-color: rgba(191, 219, 254, 0.75);
        }
        .interactive-viz .header-actions {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .interactive-viz .header-actions .button-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.12);
            color: #fff;
            border: none;
            padding: 9px 18px;
            border-radius: 999px;
            font-weight: 600;
            font-size: 0.9rem;
            text-decoration: none;
            transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
        }
        .interactive-viz .header-actions .button-link:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            background: rgba(255,255,255,0.18);
        }
        .interactive-viz .header button { background: rgba(255,255,255,0.92); color: #111827; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease; }
        .interactive-viz .header button:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(255,255,255,0.35); }
        .interactive-viz .question-details { 
            position: relative;
            padding: 18px 24px 40px; 
            border-bottom: 1px solid #e5e7eb; 
            display: block; 
            background: #f8fafc; 
            line-height: 1.55;
            overflow: hidden;
            max-height: calc(1.35em * 3 + 1.55em * 2 + 1em);
        }
        .interactive-viz .question-preview-title {
            margin: 0 0 0.15rem;
            font-size: 1.05rem;
            font-weight: 600;
            color: #0f172a;
            line-height: 1.35;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .interactive-viz .question-preview-title a {
            color: inherit;
            text-decoration: none;
            border-bottom: 1px solid rgba(15, 23, 42, 0.2);
            transition: border-bottom-color 0.2s ease;
        }
        .interactive-viz .question-preview-title a:hover {
            border-bottom-color: rgba(15, 23, 42, 0.6);
        }
        .interactive-viz .question-details::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            height: 20px;
            background: linear-gradient(180deg, rgba(248, 250, 252, 0) 0%, #f8fafc 90%);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
        }
        .interactive-viz .question-details .question-content {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1.55;
            min-height: calc(1.55em * 2);
            font-size: 0.98rem;
            margin-bottom: 4px;
        }
        .interactive-viz .question-details .question-content > * {
            display: inline;
            margin: 0;
        }
        .interactive-viz .question-details .question-content p + p::before {
            content: " ";
        }
        .interactive-viz .question-details .view-full-context-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            position: static;
            background: none;
            color: #1d4ed8;
            border: none;
            border-radius: 0;
            padding: 4px 0;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            opacity: 1;
            pointer-events: auto;
            transition: color 0.2s ease, transform 0.2s ease;
            transform: translateY(0);
            box-shadow: none;
        }
        .interactive-viz .question-details .view-full-context-btn:hover,
        .interactive-viz .question-details .view-full-context-btn:focus-visible {
            transform: translateY(0);
            color: #0b3b9c;
        }
        .interactive-viz .question-details .view-full-context-btn:focus-visible {
            outline: 2px solid rgba(59, 130, 246, 0.4);
            outline-offset: 2px;
        }
        .interactive-viz .question-details.is-clamped::after {
            opacity: 1;
        }
        .interactive-viz .answer-line-count {
            margin: 0 0 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            color: #1d4ed8;
        }
        .interactive-viz .view-reasoning-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: none;
            color: #1d4ed8;
            border: none;
            font-weight: 600;
            padding: 4px 0;
            cursor: pointer;
            font-size: 0.85rem;
            margin-bottom: 6px;
        }
        .interactive-viz .view-reasoning-btn:hover,
        .interactive-viz .view-reasoning-btn:focus-visible {
            color: #0b3b9c;
        }
        .interactive-viz .control-bar { padding: 20px 28px; display: flex; flex-wrap: wrap; gap: 16px; align-items: center; border-bottom: 1px solid #e5e7eb; }
        .interactive-viz .control-bar button { background: #2563eb; color: #fff; border: none; padding: 10px 18px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: background 0.15s ease; }
        .interactive-viz .control-bar button:hover { background: #1d4ed8; }
        .interactive-viz .model-selection { display: flex; flex-wrap: wrap; gap: 10px; }
        .interactive-viz .model-checkbox { display: flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 999px; background: #f9fafb; cursor: pointer; transition: border-color 0.15s ease, background 0.15s ease; }
        .interactive-viz .model-checkbox input { accent-color: #2563eb; cursor: pointer; }
        .interactive-viz .model-checkbox:hover { border-color: #2563eb; background: #f3f4ff; }
        .interactive-viz .panels-container { padding: 12px 2% 16px; display: flex; flex-direction: column; gap: 16px; }
        .interactive-viz .model-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .interactive-viz .model-header img { width: 36px; height: 36px; object-fit: contain; border-radius: 8px; background: #fff; box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12); }
        .interactive-viz .model-header h2 { margin: 0; font-size: 1.05rem; font-weight: 600; color: #0f172a; }
        .interactive-viz .model-header h2 a {
            color: inherit;
            text-decoration: none;
            border-bottom: 1px solid rgba(37, 99, 235, 0.35);
            transition: color 0.15s ease, border-bottom-color 0.15s ease;
        }
        .interactive-viz .model-header h2 a:hover {
            color: #2563eb;
            border-bottom-color: rgba(37, 99, 235, 0.8);
        }
        .interactive-viz .model-panels { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); }
        .interactive-viz .panel { border: none; border-radius: 0; padding: 0; display: flex; flex-direction: column; gap: 14px; background: transparent; min-height: 450px; box-shadow: none; }
        .interactive-viz .panel h3 { margin: 0; font-size: 0.95rem; color: #1f2937; font-weight: 700; }
        .interactive-viz .math-answer, .interactive-viz .final-answer { border-radius: 10px; line-height: 1.6; max-height: 400px; overflow-y: auto; }
        .interactive-viz .math-answer { background: #f1f5f9; border-left: 4px solid #0ea5e9; padding: 12px 12px; }
        .interactive-viz .final-answer { background: #e0f2fe; border-left: 4px solid #0284c7; padding: 12px 12px; font-weight: 600; color: #0f172a; }
        .interactive-viz pre { margin: 0; border-radius: 10px; overflow: auto; max-height: 400px; }
        .interactive-viz pre.code-block {
            display: grid;
            grid-template-columns: auto 1fr;
            padding: 0;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }
        .interactive-viz pre.code-block code {
            display: block;
            font-size: 0.9rem;
            line-height: 1.45;
            padding: 12px 12px;
            min-width: 0;
            white-space: pre;
        }
        .interactive-viz pre.code-block .line-numbers {
            display: inline-flex;
            flex-direction: column;
            align-items: flex-end;
            padding: 12px 12px 12px 12px;
            font-family: "JetBrains Mono", "Fira Code", Consolas, monospace;
            font-size: 0.9rem;
            line-height: 1.45;
            color: #94a3b8;
            background: rgba(148, 163, 184, 0.12);
            border-right: 1px solid rgba(148, 163, 184, 0.35);
            user-select: none;
            min-width: 3ch;
        }
        .interactive-viz pre.code-block .line-numbers span {
            display: block;
        }
        .interactive-viz .inline-code {
            font-family: "JetBrains Mono", "Fira Code", Consolas, monospace;
            background: rgba(15, 23, 42, 0.08);
            color: #0f172a;
            border-radius: 6px;
            padding: 0.1rem 0.35rem;
            font-size: 0.92em;
            white-space: pre;
        }
        .interactive-viz .empty-state { text-align: center; padding: 40px; border: 1px dashed #cbd5f5; border-radius: 12px; color: #64748b; background: #f8fafc; }
        
        /* Hover view button styles */
        .interactive-viz .content-container { position: relative; }
        .interactive-viz .view-separate-btn { 
            position: absolute; 
            top: 8px; 
            right: 8px; 
            background: rgba(0, 0, 0, 0.7); 
            color: white; 
            border: none; 
            padding: 6px 12px; 
            border-radius: 6px; 
            font-size: 0.8rem; 
            cursor: pointer; 
            opacity: 0; 
            transition: opacity 0.2s ease; 
            z-index: 10;
        }
        .interactive-viz .content-container:hover .view-separate-btn { opacity: 1; }
        .interactive-viz .view-separate-btn:hover { background: rgba(0, 0, 0, 0.9); }
        
        /* Modal styles */
        .interactive-viz .modal { 
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            background-color: rgba(0, 0, 0, 0.5); 
        }
        .interactive-viz .modal-content { 
            background-color: #fff; 
            margin: 5% auto; 
            padding: 20px; 
            border-radius: 12px; 
            width: 90%; 
            max-width: 1000px; 
            height: 80vh; 
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .interactive-viz .modal-close { 
            position: absolute; 
            top: 16px; 
            right: 20px; 
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 24px; 
            font-weight: bold; 
            cursor: pointer; 
            color: #64748b;
            line-height: 1;
            transition: background 0.2s ease, color 0.2s ease;
        }
        .interactive-viz .modal-close:hover { 
            color: #1f2933; 
            background: rgba(148, 163, 184, 0.2);
        }
        .interactive-viz .modal-close::before,
        .interactive-viz .modal-close::after {
            content: none;
        }
        .interactive-viz .modal-header { 
            margin-bottom: 20px; 
            padding-bottom: 10px; 
            border-bottom: 1px solid #eee; 
            flex-shrink: 0;
        }
        .interactive-viz #modal-body { 
            flex: 1; 
            overflow: auto; 
            min-height: 0;
            padding-right: 4px;
        }
        .interactive-viz #modal-body pre { 
            margin: 0;
            background: #f8f8f8;
            border: 1px solid #e1e4e8;
            overflow: visible;
        }
        .interactive-viz #modal-body pre.code-block { 
            height: auto; 
            max-height: none; 
            background: #f8f8f8;
            border: 1px solid #e1e4e8;
            overflow-x: auto;
            overflow-y: visible;
        }
        .interactive-viz #modal-body pre.code-block .line-numbers {
            background: #eef2f6;
        }
        .interactive-viz #modal-body .math-answer, 
        .interactive-viz #modal-body .final-answer { 
            height: 100%; 
            max-height: none; 
            overflow-y: auto;
        }
        
        /* Leakage container styles */
        .interactive-viz-leakage { margin: 0; font-family: "Inter", Arial, sans-serif; background: #eef2f7; color: #1c1c1c; }
        .interactive-viz-leakage .wrapper { max-width: 1280px; margin: 32px auto; background: #fff; border-radius: 14px; box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12); overflow: hidden; }
        .interactive-viz-leakage .header { padding: 12px 20px; background: linear-gradient(135deg, #dc2626, #991b1b); color: #fff; display: flex; justify-content: space-between; align-items: center; }
        .interactive-viz-leakage .header h1 { margin: 0; font-size: 0.95rem; font-weight: 600; max-width: 75%; letter-spacing: 0.01em; }
        .interactive-viz-leakage .header h1 a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(255,255,255,0.35); transition: color 0.15s ease, border-bottom-color 0.15s ease; }
        .interactive-viz-leakage .header h1 a:hover { color: #fca5a5; border-bottom-color: rgba(252, 165, 165, 0.75); }
        .interactive-viz-leakage .header-actions { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .interactive-viz-leakage .header-actions .button-link { display: inline-flex; align-items: center; gap: 6px; background: rgba(255,255,255,0.12); color: #fff; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; font-size: 0.9rem; text-decoration: none; transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease; }
        .interactive-viz-leakage .header-actions .button-link:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(0,0,0,0.25); background: rgba(255,255,255,0.18); }
        .interactive-viz-leakage .header button { background: rgba(255,255,255,0.92); color: #991b1b; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease; }
        .interactive-viz-leakage .header button:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(255,255,255,0.35); }
        .interactive-viz-leakage .question-details { position: relative; padding: 18px 24px 40px; border-bottom: 1px solid #e5e7eb; display: block; background: #fef2f2; line-height: 1.55; overflow: hidden; max-height: calc(1.35em * 3 + 1.55em * 2 + 1em); }
        .interactive-viz-leakage .question-preview-title { margin: 0 0 0.15rem; font-size: 1.05rem; font-weight: 600; color: #0f172a; line-height: 1.35; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .interactive-viz-leakage .question-preview-title a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(15, 23, 42, 0.2); transition: border-bottom-color 0.2s ease; }
        .interactive-viz-leakage .question-preview-title a:hover { border-bottom-color: rgba(15, 23, 42, 0.6); }
        .interactive-viz-leakage .question-details::after { content: ""; position: absolute; left: 0; right: 0; bottom: 0; height: 20px; background: linear-gradient(180deg, rgba(254, 242, 242, 0) 0%, #fef2f2 90%); pointer-events: none; opacity: 0; transition: opacity 0.2s ease; }
        .interactive-viz-leakage .question-details .question-content { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; line-height: 1.55; min-height: calc(1.55em * 2); font-size: 0.98rem; margin-bottom: 4px; }
        .interactive-viz-leakage .question-details .question-content > * { display: inline; margin: 0; }
        .interactive-viz-leakage .question-details .question-content p + p::before { content: " "; }
        .interactive-viz-leakage .question-details .view-full-context-btn { display: inline-flex; align-items: center; gap: 6px; position: static; background: none; color: #dc2626; border: none; border-radius: 0; padding: 4px 0; font-size: 0.85rem; font-weight: 600; cursor: pointer; opacity: 1; pointer-events: auto; transition: color 0.2s ease, transform 0.2s ease; transform: translateY(0); box-shadow: none; }
        .interactive-viz-leakage .question-details .view-full-context-btn:hover, .interactive-viz-leakage .question-details .view-full-context-btn:focus-visible { transform: translateY(0); color: #991b1b; }
        .interactive-viz-leakage .question-details .view-full-context-btn:focus-visible { outline: 2px solid rgba(220, 38, 38, 0.4); outline-offset: 2px; }
        .interactive-viz-leakage .question-details.is-clamped::after { opacity: 1; }
        .interactive-viz-leakage .answer-line-count { margin: 0 0 6px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; color: #dc2626; }
        .interactive-viz-leakage .view-reasoning-btn { display: inline-flex; align-items: center; gap: 6px; background: none; color: #dc2626; border: none; font-weight: 600; padding: 4px 0; cursor: pointer; font-size: 0.85rem; margin-bottom: 6px; }
        .interactive-viz-leakage .view-reasoning-btn:hover, .interactive-viz-leakage .view-reasoning-btn:focus-visible { color: #991b1b; }
        .interactive-viz-leakage .control-bar { padding: 20px 28px; display: flex; flex-wrap: wrap; gap: 16px; align-items: center; border-bottom: 1px solid #e5e7eb; }
        .interactive-viz-leakage .control-bar button { background: #dc2626; color: #fff; border: none; padding: 10px 18px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: background 0.15s ease; }
        .interactive-viz-leakage .control-bar button:hover { background: #b91c1c; }
        .interactive-viz-leakage .model-selection { display: flex; flex-wrap: wrap; gap: 10px; }
        .interactive-viz-leakage .model-checkbox { display: flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 999px; background: #f9fafb; cursor: pointer; transition: border-color 0.15s ease, background 0.15s ease; }
        .interactive-viz-leakage .model-checkbox input { accent-color: #dc2626; cursor: pointer; }
        .interactive-viz-leakage .model-checkbox:hover { border-color: #dc2626; background: #fef2f2; }
        .interactive-viz-leakage .panels-container { padding: 12px 2% 16px; display: flex; flex-direction: column; gap: 16px; }
        .interactive-viz-leakage .model-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .interactive-viz-leakage .model-header img { width: 36px; height: 36px; object-fit: contain; border-radius: 8px; background: #fff; box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12); }
        .interactive-viz-leakage .model-header h2 { margin: 0; font-size: 1.05rem; font-weight: 600; color: #0f172a; }
        .interactive-viz-leakage .model-header h2 a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(220, 38, 38, 0.35); transition: color 0.15s ease, border-bottom-color 0.15s ease; }
        .interactive-viz-leakage .model-header h2 a:hover { color: #dc2626; border-bottom-color: rgba(220, 38, 38, 0.8); }
        .interactive-viz-leakage .model-panels { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); }
        .interactive-viz-leakage .panel { border: none; border-radius: 0; padding: 0; display: flex; flex-direction: column; gap: 14px; background: transparent; min-height: 450px; box-shadow: none; }
        .interactive-viz-leakage .panel h3 { margin: 0; font-size: 0.95rem; color: #1f2937; font-weight: 700; }
        .interactive-viz-leakage .math-answer, .interactive-viz-leakage .final-answer { border-radius: 10px; line-height: 1.6; max-height: 400px; overflow-y: auto; }
        .interactive-viz-leakage .math-answer { background: #fef2f2; border-left: 4px solid #dc2626; padding: 12px 12px; }
        .interactive-viz-leakage .final-answer { background: #fee2e2; border-left: 4px solid #b91c1c; padding: 12px 12px; font-weight: 600; color: #0f172a; }
        .interactive-viz-leakage pre { margin: 0; border-radius: 10px; overflow: auto; max-height: 400px; }
        .interactive-viz-leakage pre.code-block { display: grid; grid-template-columns: auto 1fr; padding: 0; background: #fef2f2; border: 1px solid #fecaca; }
        .interactive-viz-leakage pre.code-block code { display: block; font-size: 0.9rem; line-height: 1.45; padding: 12px 12px; min-width: 0; white-space: pre; }
        .interactive-viz-leakage pre.code-block .line-numbers { display: inline-flex; flex-direction: column; align-items: flex-end; padding: 12px 12px 12px 12px; font-family: "JetBrains Mono", "Fira Code", Consolas, monospace; font-size: 0.9rem; line-height: 1.45; color: #94a3b8; background: rgba(220, 38, 38, 0.12); border-right: 1px solid rgba(220, 38, 38, 0.35); user-select: none; min-width: 3ch; }
        .interactive-viz-leakage pre.code-block .line-numbers span { display: block; }
        .interactive-viz-leakage .inline-code { font-family: "JetBrains Mono", "Fira Code", Consolas, monospace; background: rgba(220, 38, 38, 0.08); color: #0f172a; border-radius: 6px; padding: 0.1rem 0.35rem; font-size: 0.92em; white-space: pre; }
        .interactive-viz-leakage .empty-state { text-align: center; padding: 40px; border: 1px dashed #fecaca; border-radius: 12px; color: #64748b; background: #fef2f2; }
        .interactive-viz-leakage .content-container { position: relative; }
        .interactive-viz-leakage .view-separate-btn { position: absolute; top: 8px; right: 8px; background: rgba(0, 0, 0, 0.7); color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; opacity: 0; transition: opacity 0.2s ease; z-index: 10; }
        .interactive-viz-leakage .content-container:hover .view-separate-btn { opacity: 1; }
        .interactive-viz-leakage .view-separate-btn:hover { background: rgba(0, 0, 0, 0.9); }
        .interactive-viz-leakage .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); }
        .interactive-viz-leakage .modal-content { background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 12px; width: 90%; max-width: 1000px; height: 80vh; position: relative; display: flex; flex-direction: column; overflow: hidden; }
        .interactive-viz-leakage .modal-close { position: absolute; top: 16px; right: 20px; display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; border-radius: 50%; font-size: 24px; font-weight: bold; cursor: pointer; color: #64748b; line-height: 1; transition: background 0.2s ease, color 0.2s ease; }
        .interactive-viz-leakage .modal-close:hover { color: #1f2933; background: rgba(148, 163, 184, 0.2); }
        .interactive-viz-leakage .modal-close::before, .interactive-viz-leakage .modal-close::after { content: none; }
        .interactive-viz-leakage .modal-header { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #eee; flex-shrink: 0; }
        .interactive-viz-leakage #modal-body-leakage { flex: 1; overflow: auto; min-height: 0; padding-right: 4px; }
        .interactive-viz-leakage #modal-body-leakage pre { margin: 0; background: #fef2f2; border: 1px solid #fecaca; overflow: visible; }
        .interactive-viz-leakage #modal-body-leakage pre.code-block { height: auto; max-height: none; background: #fef2f2; border: 1px solid #fecaca; overflow-x: auto; overflow-y: visible; }
        .interactive-viz-leakage #modal-body-leakage pre.code-block .line-numbers { background: #fee2e2; }
        .interactive-viz-leakage #modal-body-leakage .math-answer, .interactive-viz-leakage #modal-body-leakage .final-answer { height: 100%; max-height: none; overflow-y: auto; }
        
        /* Panic container styles */
        .interactive-viz-panic { margin: 0; font-family: "Inter", Arial, sans-serif; background: #eef2f7; color: #1c1c1c; }
        .interactive-viz-panic .wrapper { max-width: 1280px; margin: 32px auto; background: #fff; border-radius: 14px; box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12); overflow: hidden; }
        .interactive-viz-panic .header { padding: 12px 20px; background: linear-gradient(135deg, #ea580c, #c2410c); color: #fff; display: flex; justify-content: space-between; align-items: center; }
        .interactive-viz-panic .header h1 { margin: 0; font-size: 0.95rem; font-weight: 600; max-width: 75%; letter-spacing: 0.01em; }
        .interactive-viz-panic .header h1 a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(255,255,255,0.35); transition: color 0.15s ease, border-bottom-color 0.15s ease; }
        .interactive-viz-panic .header h1 a:hover { color: #fed7aa; border-bottom-color: rgba(254, 215, 170, 0.75); }
        .interactive-viz-panic .header-actions { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .interactive-viz-panic .header-actions .button-link { display: inline-flex; align-items: center; gap: 6px; background: rgba(255,255,255,0.12); color: #fff; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; font-size: 0.9rem; text-decoration: none; transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease; }
        .interactive-viz-panic .header-actions .button-link:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(0,0,0,0.25); background: rgba(255,255,255,0.18); }
        .interactive-viz-panic .header button { background: rgba(255,255,255,0.92); color: #c2410c; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease; }
        .interactive-viz-panic .header button:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(255,255,255,0.35); }
        .interactive-viz-panic .question-details { position: relative; padding: 18px 24px 40px; border-bottom: 1px solid #e5e7eb; display: block; background: #fff7ed; line-height: 1.55; overflow: hidden; max-height: calc(1.35em * 3 + 1.55em * 2 + 1em); }
        .interactive-viz-panic .question-preview-title { margin: 0 0 0.15rem; font-size: 1.05rem; font-weight: 600; color: #0f172a; line-height: 1.35; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .interactive-viz-panic .question-preview-title a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(15, 23, 42, 0.2); transition: border-bottom-color 0.2s ease; }
        .interactive-viz-panic .question-preview-title a:hover { border-bottom-color: rgba(15, 23, 42, 0.6); }
        .interactive-viz-panic .question-details::after { content: ""; position: absolute; left: 0; right: 0; bottom: 0; height: 20px; background: linear-gradient(180deg, rgba(255, 247, 237, 0) 0%, #fff7ed 90%); pointer-events: none; opacity: 0; transition: opacity 0.2s ease; }
        .interactive-viz-panic .question-details .question-content { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; line-height: 1.55; min-height: calc(1.55em * 2); font-size: 0.98rem; margin-bottom: 4px; }
        .interactive-viz-panic .question-details .question-content > * { display: inline; margin: 0; }
        .interactive-viz-panic .question-details .question-content p + p::before { content: " "; }
        .interactive-viz-panic .question-details .view-full-context-btn { display: inline-flex; align-items: center; gap: 6px; position: static; background: none; color: #ea580c; border: none; border-radius: 0; padding: 4px 0; font-size: 0.85rem; font-weight: 600; cursor: pointer; opacity: 1; pointer-events: auto; transition: color 0.2s ease, transform 0.2s ease; transform: translateY(0); box-shadow: none; }
        .interactive-viz-panic .question-details .view-full-context-btn:hover, .interactive-viz-panic .question-details .view-full-context-btn:focus-visible { transform: translateY(0); color: #c2410c; }
        .interactive-viz-panic .question-details .view-full-context-btn:focus-visible { outline: 2px solid rgba(234, 88, 12, 0.4); outline-offset: 2px; }
        .interactive-viz-panic .question-details.is-clamped::after { opacity: 1; }
        .interactive-viz-panic .answer-line-count { margin: 0 0 6px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; color: #ea580c; }
        .interactive-viz-panic .view-reasoning-btn { display: inline-flex; align-items: center; gap: 6px; background: none; color: #ea580c; border: none; font-weight: 600; padding: 4px 0; cursor: pointer; font-size: 0.85rem; margin-bottom: 6px; }
        .interactive-viz-panic .view-reasoning-btn:hover, .interactive-viz-panic .view-reasoning-btn:focus-visible { color: #c2410c; }
        .interactive-viz-panic .control-bar { padding: 20px 28px; display: flex; flex-wrap: wrap; gap: 16px; align-items: center; border-bottom: 1px solid #e5e7eb; }
        .interactive-viz-panic .control-bar button { background: #ea580c; color: #fff; border: none; padding: 10px 18px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: background 0.15s ease; }
        .interactive-viz-panic .control-bar button:hover { background: #c2410c; }
        .interactive-viz-panic .model-selection { display: flex; flex-wrap: wrap; gap: 10px; }
        .interactive-viz-panic .model-checkbox { display: flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 999px; background: #f9fafb; cursor: pointer; transition: border-color 0.15s ease, background 0.15s ease; }
        .interactive-viz-panic .model-checkbox input { accent-color: #ea580c; cursor: pointer; }
        .interactive-viz-panic .model-checkbox:hover { border-color: #ea580c; background: #fff7ed; }
        .interactive-viz-panic .panels-container { padding: 12px 2% 16px; display: flex; flex-direction: column; gap: 16px; }
        .interactive-viz-panic .model-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .interactive-viz-panic .model-header img { width: 36px; height: 36px; object-fit: contain; border-radius: 8px; background: #fff; box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12); }
        .interactive-viz-panic .model-header h2 { margin: 0; font-size: 1.05rem; font-weight: 600; color: #0f172a; }
        .interactive-viz-panic .model-header h2 a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(234, 88, 12, 0.35); transition: color 0.15s ease, border-bottom-color 0.15s ease; }
        .interactive-viz-panic .model-header h2 a:hover { color: #ea580c; border-bottom-color: rgba(234, 88, 12, 0.8); }
        .interactive-viz-panic .model-panels { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); }
        .interactive-viz-panic .panel { border: none; border-radius: 0; padding: 0; display: flex; flex-direction: column; gap: 14px; background: transparent; min-height: 450px; box-shadow: none; }
        .interactive-viz-panic .panel h3 { margin: 0; font-size: 0.95rem; color: #1f2937; font-weight: 700; }
        .interactive-viz-panic .math-answer, .interactive-viz-panic .final-answer { border-radius: 10px; line-height: 1.6; max-height: 400px; overflow-y: auto; }
        .interactive-viz-panic .math-answer { background: #fff7ed; border-left: 4px solid #ea580c; padding: 12px 12px; }
        .interactive-viz-panic .final-answer { background: #fed7aa; border-left: 4px solid #c2410c; padding: 12px 12px; font-weight: 600; color: #0f172a; }
        .interactive-viz-panic pre { margin: 0; border-radius: 10px; overflow: auto; max-height: 400px; }
        .interactive-viz-panic pre.code-block { display: grid; grid-template-columns: auto 1fr; padding: 0; background: #fff7ed; border: 1px solid #fed7aa; }
        .interactive-viz-panic pre.code-block code { display: block; font-size: 0.9rem; line-height: 1.45; padding: 12px 12px; min-width: 0; white-space: pre; }
        .interactive-viz-panic pre.code-block .line-numbers { display: inline-flex; flex-direction: column; align-items: flex-end; padding: 12px 12px 12px 12px; font-family: "JetBrains Mono", "Fira Code", Consolas, monospace; font-size: 0.9rem; line-height: 1.45; color: #94a3b8; background: rgba(234, 88, 12, 0.12); border-right: 1px solid rgba(234, 88, 12, 0.35); user-select: none; min-width: 3ch; }
        .interactive-viz-panic pre.code-block .line-numbers span { display: block; }
        .interactive-viz-panic .inline-code { font-family: "JetBrains Mono", "Fira Code", Consolas, monospace; background: rgba(234, 88, 12, 0.08); color: #0f172a; border-radius: 6px; padding: 0.1rem 0.35rem; font-size: 0.92em; white-space: pre; }
        .interactive-viz-panic .empty-state { text-align: center; padding: 40px; border: 1px dashed #fed7aa; border-radius: 12px; color: #64748b; background: #fff7ed; }
        .interactive-viz-panic .content-container { position: relative; }
        .interactive-viz-panic .view-separate-btn { position: absolute; top: 8px; right: 8px; background: rgba(0, 0, 0, 0.7); color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; opacity: 0; transition: opacity 0.2s ease; z-index: 10; }
        .interactive-viz-panic .content-container:hover .view-separate-btn { opacity: 1; }
        .interactive-viz-panic .view-separate-btn:hover { background: rgba(0, 0, 0, 0.9); }
        .interactive-viz-panic .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); }
        .interactive-viz-panic .modal-content { background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 12px; width: 90%; max-width: 1000px; height: 80vh; position: relative; display: flex; flex-direction: column; overflow: hidden; }
        .interactive-viz-panic .modal-close { position: absolute; top: 16px; right: 20px; display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; border-radius: 50%; font-size: 24px; font-weight: bold; cursor: pointer; color: #64748b; line-height: 1; transition: background 0.2s ease, color 0.2s ease; }
        .interactive-viz-panic .modal-close:hover { color: #1f2933; background: rgba(148, 163, 184, 0.2); }
        .interactive-viz-panic .modal-close::before, .interactive-viz-panic .modal-close::after { content: none; }
        .interactive-viz-panic .modal-header { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #eee; flex-shrink: 0; }
        .interactive-viz-panic #modal-body-panic { flex: 1; overflow: auto; min-height: 0; padding-right: 4px; }
        .interactive-viz-panic #modal-body-panic pre { margin: 0; background: #fff7ed; border: 1px solid #fed7aa; overflow: visible; }
        .interactive-viz-panic #modal-body-panic pre.code-block { height: auto; max-height: none; background: #fff7ed; border: 1px solid #fed7aa; overflow-x: auto; overflow-y: visible; }
        .interactive-viz-panic #modal-body-panic pre.code-block .line-numbers { background: #fed7aa; }
        .interactive-viz-panic #modal-body-panic .math-answer, .interactive-viz-panic #modal-body-panic .final-answer { height: 100%; max-height: none; overflow-y: auto; }
        
        /* Doubt container styles */
        .interactive-viz-doubt { margin: 0; font-family: "Inter", Arial, sans-serif; background: #eef2f7; color: #1c1c1c; }
        .interactive-viz-doubt .wrapper { max-width: 1280px; margin: 32px auto; background: #fff; border-radius: 14px; box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12); overflow: hidden; }
        .interactive-viz-doubt .header { padding: 12px 20px; background: linear-gradient(135deg, #7c3aed, #5b21b6); color: #fff; display: flex; justify-content: space-between; align-items: center; }
        .interactive-viz-doubt .header h1 { margin: 0; font-size: 0.95rem; font-weight: 600; max-width: 75%; letter-spacing: 0.01em; }
        .interactive-viz-doubt .header h1 a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(255,255,255,0.35); transition: color 0.15s ease, border-bottom-color 0.15s ease; }
        .interactive-viz-doubt .header h1 a:hover { color: #c4b5fd; border-bottom-color: rgba(196, 181, 253, 0.75); }
        .interactive-viz-doubt .header-actions { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .interactive-viz-doubt .header-actions .button-link { display: inline-flex; align-items: center; gap: 6px; background: rgba(255,255,255,0.12); color: #fff; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; font-size: 0.9rem; text-decoration: none; transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease; }
        .interactive-viz-doubt .header-actions .button-link:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(0,0,0,0.25); background: rgba(255,255,255,0.18); }
        .interactive-viz-doubt .header button { background: rgba(255,255,255,0.92); color: #5b21b6; border: none; padding: 9px 18px; border-radius: 999px; font-weight: 600; cursor: pointer; transition: transform 0.15s ease, box-shadow 0.15s ease; }
        .interactive-viz-doubt .header button:hover { transform: translateY(-1px); box-shadow: 0 6px 16px rgba(255,255,255,0.35); }
        .interactive-viz-doubt .question-details { position: relative; padding: 18px 24px 40px; border-bottom: 1px solid #e5e7eb; display: block; background: #faf5ff; line-height: 1.55; overflow: hidden; max-height: calc(1.35em * 3 + 1.55em * 2 + 1em); }
        .interactive-viz-doubt .question-preview-title { margin: 0 0 0.15rem; font-size: 1.05rem; font-weight: 600; color: #0f172a; line-height: 1.35; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .interactive-viz-doubt .question-preview-title a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(15, 23, 42, 0.2); transition: border-bottom-color 0.2s ease; }
        .interactive-viz-doubt .question-preview-title a:hover { border-bottom-color: rgba(15, 23, 42, 0.6); }
        .interactive-viz-doubt .question-details::after { content: ""; position: absolute; left: 0; right: 0; bottom: 0; height: 20px; background: linear-gradient(180deg, rgba(250, 245, 255, 0) 0%, #faf5ff 90%); pointer-events: none; opacity: 0; transition: opacity 0.2s ease; }
        .interactive-viz-doubt .question-details .question-content { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; line-height: 1.55; min-height: calc(1.55em * 2); font-size: 0.98rem; margin-bottom: 4px; }
        .interactive-viz-doubt .question-details .question-content > * { display: inline; margin: 0; }
        .interactive-viz-doubt .question-details .question-content p + p::before { content: " "; }
        .interactive-viz-doubt .question-details .view-full-context-btn { display: inline-flex; align-items: center; gap: 6px; position: static; background: none; color: #7c3aed; border: none; border-radius: 0; padding: 4px 0; font-size: 0.85rem; font-weight: 600; cursor: pointer; opacity: 1; pointer-events: auto; transition: color 0.2s ease, transform 0.2s ease; transform: translateY(0); box-shadow: none; }
        .interactive-viz-doubt .question-details .view-full-context-btn:hover, .interactive-viz-doubt .question-details .view-full-context-btn:focus-visible { transform: translateY(0); color: #5b21b6; }
        .interactive-viz-doubt .question-details .view-full-context-btn:focus-visible { outline: 2px solid rgba(124, 58, 237, 0.4); outline-offset: 2px; }
        .interactive-viz-doubt .question-details.is-clamped::after { opacity: 1; }
        .interactive-viz-doubt .answer-line-count { margin: 0 0 6px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; color: #7c3aed; }
        .interactive-viz-doubt .view-reasoning-btn { display: inline-flex; align-items: center; gap: 6px; background: none; color: #7c3aed; border: none; font-weight: 600; padding: 4px 0; cursor: pointer; font-size: 0.85rem; margin-bottom: 6px; }
        .interactive-viz-doubt .view-reasoning-btn:hover, .interactive-viz-doubt .view-reasoning-btn:focus-visible { color: #5b21b6; }
        .interactive-viz-doubt .control-bar { padding: 20px 28px; display: flex; flex-wrap: wrap; gap: 16px; align-items: center; border-bottom: 1px solid #e5e7eb; }
        .interactive-viz-doubt .control-bar button { background: #7c3aed; color: #fff; border: none; padding: 10px 18px; border-radius: 10px; font-weight: 600; cursor: pointer; transition: background 0.15s ease; }
        .interactive-viz-doubt .control-bar button:hover { background: #5b21b6; }
        .interactive-viz-doubt .model-selection { display: flex; flex-wrap: wrap; gap: 10px; }
        .interactive-viz-doubt .model-checkbox { display: flex; align-items: center; gap: 8px; padding: 8px 12px; border: 1px solid #d1d5db; border-radius: 999px; background: #f9fafb; cursor: pointer; transition: border-color 0.15s ease, background 0.15s ease; }
        .interactive-viz-doubt .model-checkbox input { accent-color: #7c3aed; cursor: pointer; }
        .interactive-viz-doubt .model-checkbox:hover { border-color: #7c3aed; background: #faf5ff; }
        .interactive-viz-doubt .panels-container { padding: 12px 2% 16px; display: flex; flex-direction: column; gap: 16px; }
        .interactive-viz-doubt .model-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
        .interactive-viz-doubt .model-header img { width: 36px; height: 36px; object-fit: contain; border-radius: 8px; background: #fff; box-shadow: 0 4px 12px rgba(15, 23, 42, 0.12); }
        .interactive-viz-doubt .model-header h2 { margin: 0; font-size: 1.05rem; font-weight: 600; color: #0f172a; }
        .interactive-viz-doubt .model-header h2 a { color: inherit; text-decoration: none; border-bottom: 1px solid rgba(124, 58, 237, 0.35); transition: color 0.15s ease, border-bottom-color 0.15s ease; }
        .interactive-viz-doubt .model-header h2 a:hover { color: #7c3aed; border-bottom-color: rgba(124, 58, 237, 0.8); }
        .interactive-viz-doubt .model-panels { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); }
        .interactive-viz-doubt .panel { border: none; border-radius: 0; padding: 0; display: flex; flex-direction: column; gap: 14px; background: transparent; min-height: 450px; box-shadow: none; }
        .interactive-viz-doubt .panel h3 { margin: 0; font-size: 0.95rem; color: #1f2937; font-weight: 700; }
        .interactive-viz-doubt .math-answer, .interactive-viz-doubt .final-answer { border-radius: 10px; line-height: 1.6; max-height: 400px; overflow-y: auto; }
        .interactive-viz-doubt .math-answer { background: #faf5ff; border-left: 4px solid #7c3aed; padding: 12px 12px; }
        .interactive-viz-doubt .final-answer { background: #e9d5ff; border-left: 4px solid #5b21b6; padding: 12px 12px; font-weight: 600; color: #0f172a; }
        .interactive-viz-doubt pre { margin: 0; border-radius: 10px; overflow: auto; max-height: 400px; }
        .interactive-viz-doubt pre.code-block { display: grid; grid-template-columns: auto 1fr; padding: 0; background: #faf5ff; border: 1px solid #e9d5ff; }
        .interactive-viz-doubt pre.code-block code { display: block; font-size: 0.9rem; line-height: 1.45; padding: 12px 12px; min-width: 0; white-space: pre; }
        .interactive-viz-doubt pre.code-block .line-numbers { display: inline-flex; flex-direction: column; align-items: flex-end; padding: 12px 12px 12px 12px; font-family: "JetBrains Mono", "Fira Code", Consolas, monospace; font-size: 0.9rem; line-height: 1.45; color: #94a3b8; background: rgba(124, 58, 237, 0.12); border-right: 1px solid rgba(124, 58, 237, 0.35); user-select: none; min-width: 3ch; }
        .interactive-viz-doubt pre.code-block .line-numbers span { display: block; }
        .interactive-viz-doubt .inline-code { font-family: "JetBrains Mono", "Fira Code", Consolas, monospace; background: rgba(124, 58, 237, 0.08); color: #0f172a; border-radius: 6px; padding: 0.1rem 0.35rem; font-size: 0.92em; white-space: pre; }
        .interactive-viz-doubt .empty-state { text-align: center; padding: 40px; border: 1px dashed #e9d5ff; border-radius: 12px; color: #64748b; background: #faf5ff; }
        .interactive-viz-doubt .content-container { position: relative; }
        .interactive-viz-doubt .view-separate-btn { position: absolute; top: 8px; right: 8px; background: rgba(0, 0, 0, 0.7); color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer; opacity: 0; transition: opacity 0.2s ease; z-index: 10; }
        .interactive-viz-doubt .content-container:hover .view-separate-btn { opacity: 1; }
        .interactive-viz-doubt .view-separate-btn:hover { background: rgba(0, 0, 0, 0.9); }
        .interactive-viz-doubt .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); }
        .interactive-viz-doubt .modal-content { background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 12px; width: 90%; max-width: 1000px; height: 80vh; position: relative; display: flex; flex-direction: column; overflow: hidden; }
        .interactive-viz-doubt .modal-close { position: absolute; top: 16px; right: 20px; display: flex; align-items: center; justify-content: center; width: 36px; height: 36px; border-radius: 50%; font-size: 24px; font-weight: bold; cursor: pointer; color: #64748b; line-height: 1; transition: background 0.2s ease, color 0.2s ease; }
        .interactive-viz-doubt .modal-close:hover { color: #1f2933; background: rgba(148, 163, 184, 0.2); }
        .interactive-viz-doubt .modal-close::before, .interactive-viz-doubt .modal-close::after { content: none; }
        .interactive-viz-doubt .modal-header { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #eee; flex-shrink: 0; }
        .interactive-viz-doubt #modal-body-doubt { flex: 1; overflow: auto; min-height: 0; padding-right: 4px; }
        .interactive-viz-doubt #modal-body-doubt pre { margin: 0; background: #faf5ff; border: 1px solid #e9d5ff; overflow: visible; }
        .interactive-viz-doubt #modal-body-doubt pre.code-block { height: auto; max-height: none; background: #faf5ff; border: 1px solid #e9d5ff; overflow-x: auto; overflow-y: visible; }
        .interactive-viz-doubt #modal-body-doubt pre.code-block .line-numbers { background: #e9d5ff; }
        .interactive-viz-doubt #modal-body-doubt .math-answer, .interactive-viz-doubt #modal-body-doubt .final-answer { height: 100%; max-height: none; overflow-y: auto; }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
    <script defer src="static/fontawesome/js/fontawesome.min.js"></script>
    <script src="static/js/bulma-carousel.min.js"></script>
    <script src="static/js/bulma-slider.min.js"></script>
    <script src="static/js/index.js"></script>
    
    <!-- Highlight.js for code syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
    
    <!-- MathJax for LaTeX rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <!-- Floating Table of Contents -->
    <nav class="floating-toc">
        <div class="toc-title">Contents</div>
        <ul class="toc-list">
            <li class="toc-item"><a href="#overview" class="toc-link">Overview</a></li>
            <li class="toc-item"><a href="#problem-setup" class="toc-link">Problem Setup</a></li>
            <li class="toc-item"><a href="#hard-interrupt" class="toc-link">#1 Hard Interrupt</a></li>
            <li class="toc-item"><a href="#speedup" class="toc-link">#2 Speedup</a></li>
            <li class="toc-item"><a href="#update-driven" class="toc-link">#3 Info Update</a></li>
            <li class="toc-item"><a href="#acknowledgements" class="toc-link">Acknowledgment</a></li>
            <li class="toc-item"><a href="#BibTeX" class="toc-link">BibTeX</a></li>
        </ul>
    </nav>

    <section class="hero hero--landing" id="overview">
        <div class="hero-body" style="padding-top: 1.5rem;">
            <div class="container is-max-desktop">
                <div class="columns is-centered is-vcentered hero-header">
                    <div class="column is-narrow hero-logo-column">
                        <img class="hero-logo" src="static/images/ilrm_logo.png" alt="IRLM Project Logo", style="height: 100px;">
                        <div class="hero-logo-tooltip">
                            Think of The Great Wave as a metaphor for dynamic context — the chatbot has to surf the changing tides of conversation, staying robust even as the waves keep moving.
                        </div>
                    </div>
                    <div class="column has-text-centered hero-text-column">
                        <h1 class="title is-2 publication-title hero-title">Are Large Reasoning Models Interruptible?</h1>
                    </div>
                </div>
                <div class="container is-max-desktop">
                    <div class="columns is-centered">
                        <div class="column has-text-centered">
                            <div class="is-size-6 publication-authors authors-inline" style="margin-top: -1.5rem;">
                                <!-- Paper authors -->
                                <span class="author-block"><a href="https://patrickthwu.com/" target="_blank" rel="noopener">Tsung-Han Wu<sup class="has-text-danger">*</sup></a></span>
                                <span class="author-block"><a href="https://mmiroyan.github.io/" target="_blank" rel="noopener">Mihran Miroyan<sup class="has-text-danger">*</sup></a></span>
                                <span class="author-block"><a href="https://dchan.cc/" target="_blank" rel="noopener">David M. Chan</a></span>
                                <span class="author-block"><a href="https://people.eecs.berkeley.edu/~trevor/" target="_blank" rel="noopener">Trevor Darrell</a></span>
                                <span class="author-block"><a href="https://nargesnorouzi.me/" target="_blank" rel="noopener">Narges Norouzi</a></span>
                                <span class="author-block"><a href="https://people.eecs.berkeley.edu/~jegonzal/" target="_blank" rel="noopener">Joseph E. Gonzalez</a></span>
                            </div>
                            <div class="is-size-6 publication-authors" style="margin-top: 0.5rem;">
                                <span class="author-block"><strong>UC Berkeley</strong></span>
                                <br>
                                <span class="author-block"><sup class="has-text-danger">*</sup>Equal contribution</span>
                            </div>

                            <div class="column has-text-centered">
                                <div class="publication-links">

                                    <span class="link-block">
                                        <a href="https://arxiv.org/abs/2504.13169" target="_blank" class="external-link button is-normal is-rounded is-dark">
                                            <span class="icon">
                                                <i class="ai ai-arxiv"></i>
                                            </span>
                                            <span>arXiv</span>
                                        </a>
                                    </span>
                                    <!-- Model/Dataset Button -->
                                    <span class="link-block">
                                        <a href="https://huggingface.co/collections/tsunghanwu/reverse-67f410b5d147edf2ed7817ae" target="_blank" class="external-link button is-normal is-rounded is-dark">
                                            <span class="icon">
                                                <img src="https://huggingface.co/front/assets/huggingface_logo-noborder.svg" alt="Hugging Face" style="height: 20px; vertical-align: middle;">
                                            </span>
                                            <span>Dataset</span>
                                        </a>
                                    </span>

                                    <!-- Code Button -->
                                    <span class="link-block">
                                        <a href="https://github.com/tsunghan-wu/reverse_vlm" target="_blank" class="external-link button is-normal is-rounded is-dark">
                                            <span class="icon">
                                                <i class="fa-brands fa-github"></i>
                                            </span>
                                            <span>Code</span>
                                        </a>
                                    </span>
                                </div>
                                <br>
                                <!-- <p>
                                    <strong>TL;DR: </strong> We test SOTA reasoning models under <strong>mid-thinking stops, hurry-ups, and info updates</strong>, uncovering three failure modes.
                                </p> -->
                                 <div class="tldr-callout" role="note" aria-label="TLDR summary" style="margin-top: 0rem;">
                                     <div class="tldr-header">
                                       <!-- <span class="tldr-badge">TL;DR</span> -->
                                       <p class="tldr-lede">We are the first to test SOTA reasoning models under real-world interruptions and find three failure modes.</p>
                                     </div>
                                     <ul class="tldr-failures">
                                        <li class="failure-item">
                                            <span class="failure-title">Hard Interrupt → Reasoning Leakage</span>
                                            <span class="failure-desc">Spill unfinished thoughts into answers,<br>failing to actually save users' time</span>
                                          </li>
                                          <li class="failure-item">
                                            <span class="failure-title">Speedup → Panic</span>
                                            <span class="failure-desc">Rush to answer directly with unfinished reasoning, hurting accuracy</span>
                                          </li>
                                          <li class="failure-item">
                                            <span class="failure-title">Info Updates → Self-doubt</span>
                                            <span class="failure-desc">Can't adapt to new information from users<br>when conflicting with existing thoughts</span>
                                          </li>
                                     </ul>
                                   </div>
                            </div>
                        </div>
                    </div>
                </div>
                    
                <div style="text-align: center; margin-top: 2rem;">
                    <p style="color: #000000; font-size: 1.13rem; font-weight: 600;">What would happen if we interrupt LRMs when they perform 30% of the reasoning?</p>
                </div>
                
                <div class="carousel-container" style="position: relative; display: flex; align-items: center; justify-content: center; margin: 0rem 0;">
                    <!-- Left Arrow -->
                    <button class="carousel-arrow carousel-arrow-left" style="background: none; border: none; font-size: 1.5rem; color: #666; cursor: pointer; margin-right: 0.5rem;">‹</button>
                    
                     <!-- Carousel Content - Sliding Panels -->
                     <div class="carousel-content" style="position: relative; width: 850px; height: 400px; overflow: hidden; margin: 0 auto;">
                         <div class="carousel-track" style="position: absolute; top: 0; left: 0; width: 2550px; height: 100%; transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);">
                             <div class="carousel-panel" style="float: left; width: 850px; height: 100%; background: white; text-align: center; padding: 0.5rem;">
                                 <div style="background: white; border-radius: 4px; height: 360px; display: flex; align-items: center; justify-content: center;">
                                     <img src="static/images/figures_new/answer_length.png" alt="Hard Interrupt" style="max-width: 100%; max-height: 340px; object-fit: contain;">
                                 </div>
                                 <div style="text-align: center; font-weight: 500; color: #333;">Hard Interrupt → <span style="color: #FF0000;">Up to 10x longer answer length</span> with minimal time savings</div>
                             </div>
                             <div class="carousel-panel" style="float: left; width: 850px; height: 100%; background: white; text-align: center; padding: 0.5rem;">
                                 <div style="background: white; border-radius: 4px; height: 360px; display: flex; align-items: center; justify-content: center;">
                                     <img src="static/images/figures_new/panic_rate.png" alt="Speedup" style="max-width: 100%; max-height: 340px; object-fit: contain;">
                                 </div>
                                 <div style="text-align: center; font-weight: 500; color: #333;">Speedup → <span style="color: #FF0000;">Up to 90% errors stem from panic</span>, where the model answers too early without finishing its first reasoning pass</div>
                             </div>
                             <div class="carousel-panel" style="float: left; width: 850px; height: 100%; background: white; text-align: center; padding: 0.5rem;">
                                 <div style="background: white; border-radius: 4px; height: 360px; display: flex; align-items: center; justify-content: center;">
                                     <img src="static/images/figures_new/doubt_rate.png" alt="Info Update" style="max-width: 100%; max-height: 340px; object-fit: contain;">
                                 </div>
                                 <div style="text-align: center; font-weight: 500; color: #333; ">Info Update → <span style="color: #FF0000;">Up to 80% wrong cases come from self-doubt</span>, where the model fails to take new information</div>
                             </div>
                         </div>
                     </div>
                    
                    <!-- Right Arrow -->
                    <button class="carousel-arrow carousel-arrow-right" style="background: none; border: none; font-size: 1.5rem; color: #666; cursor: pointer; padding: 1rem; margin-left: 0.5rem;">›</button>
                </div>
                
                <!-- Pagination Indicators -->
                <div class="carousel-pagination" style="display: flex; justify-content: center; gap: 0.5rem; margin-top: 1rem;">
                    <span class="pagination-dot active" style="width: 5%; height: 3px; background: #000; border-radius: 2px; display: inline-block;"></span>
                    <span class="pagination-dot" style="width: 5%; height: 3px; background: #ccc; border-radius: 2px; display: inline-block;"></span>
                    <span class="pagination-dot" style="width: 5%; height: 3px; background: #ccc; border-radius: 2px; display: inline-block;"></span>
                </div>
            </div>

        </div>
    </section>
      
    <section class="section" id="problem-setup">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full">
                    <h2 class="title is-4">How Do LRMs Perform In Dynamic Worlds? 
                    </h2>
                </div>
            </div>
            <p>
                Because LRMs' reasoning and inference can take a lot of time, users don’t want to simply wait for them to finish. Instead, they often interrupt mid-inference: forcing an immediate answer (hard interrupt), asking the model to accelerate (speedup), or changing the task specification (info update). We introduce a new evaluation suite that tests how well LRMs handle these interruptions and dynamic context changes across math and coding tasks. The figure below illustrates our evaluation protocol.</p>
            <div class="item is-vcentered" style="text-align: center; width: 90%; margin: 0.5rem auto;">
                <img src="./static/images/fig2.png" style="max-width: 100%; height: auto;">
            </div>
            <p>In practice, we run a single inference session to obtain the full reasoning chain $r$ and then interrupt the interrupt message $i$ at different stages of the reasoning process ($0 \leq X < |r|$) based on different scenarios:</p>
            <ul style="list-style-type: disc; padding-left: 2rem; margin-top: 0.5rem;">
                <li><strong>Hard Interrupt → </strong> $i=\langle\text{end-think}\rangle$ or $\langle\text{force-answer}\rangle$; $r_X' = \emptyset$</li>
                <li><strong>Speedup → </strong> $i=\text{Please provide the answer as soon as possible.}$</li>
                <li><strong>Info Update →</strong> $i=\text{Update information}$</li>
            </ul>
            <p style="margin-top: 0.5rem;">For Hard Interrupt and Speedup evaluations, we directly utilized existing math and coding datasets, including GSM8K, MATH-500, AIME 24/25, and LiveCodeBench-v6. For the info update track specifically, we augmented these datasets to create a new collection containing 1401 reasoning problems with multiple conflicting information updates.</p>
            <br>
            <p>See more about out dataset (a Gallery below).</p>
        </div>
    </section>

    <section class="section" id="hard-interrupt">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full">
                    <h2 class="title is-4">Hard Interrupt: Are LRMs Truly Anytime Models?</h2>
                </div>
            </div>
            
            <!-- Hard Interrupt Content -->
            <div class="columns is-centered">
                <div class="column is-full">
              
                  <p style="margin-top: 1rem; margin-bottom: 0; line-height: 1.6;">
                    When cutting LRMs’ thinking budget in the end-thinking setup, the results look surprisingly good at first: Pass@1 does not drop much.
                 </p>
              
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    But the fun part comes after we look at the answer lengths, where most models "cheat" when told to answer right away. Even with the inserted end-thinking token, they keep reasoning inside the answer section, sneaking in extra thoughts to reach the right result.
                    This hidden reasoning, we call it <strong>reasoning leakage</strong>, makes models look smarter than they really are. 
                    Once we disable it in the force-answering setup, Pass@1 accuracy drops sharply, showing that LRMs still have room for improvement under anytime scenarios.
                  </p>
              
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    Things get even trickier in coding tasks. Models still "think" through inline comments in the force-answering setup, producing up to 10× longer code to reason their way out. 
                    It is clever, but it breaks the idea of controlled computation and disobeys the user’s instruction to answer immediately.
                  </p>
                  <div id="interactive-vis-container-leakage" style="margin: 2rem 0;">
                    <!-- Content will be loaded here by JavaScript -->
                 </div>
                  <video class="is-fullwidth" autoplay loop muted playsinline>
                    <source src="./static/images/hard_interrupt.mov" type="video/mp4">
                    Your browser does not support the video tag.
                  </video>
              
              
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    And remember the common "thinking tokens vs. accuracy" plot from prior work
                    (<a href="https://qwen.ai/blog?id=1e3fa5c2d4662af2855586055ad037ed9e555125&from=research.research-list" target="_blank">Qwen3</a> 
                    and 
                    <a href="https://huggingface.co/nvidia/NVIDIA-Nemotron-Nano-12B-v2" target="_blank">NVIDIA’s Nemotron</a>)? 
                    Our results show that this plot may not tell the full story. 
                    Longer outputs often hide extra reasoning and quietly inflate compute cost, even when the model appears to stop thinking early.
                  </p>
                  
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    Ideally, we want models that are aware of their own limits, able to estimate how much reasoning they can afford, and transparent when they cannot solve something in time. 
                    Instead of secretly thinking more during the answer, they should strike a better balance between following instructions and producing correct results.
                  </p>
                  
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    <strong>Takeaway:</strong> Current LRMs show fragile anytime behavior caused by reasoning leakage. 
                    A promising next step is to revisit the "thinking tokens vs. accuracy" metric and address leakage, so that LRMs can be deployed safely in time-critical applications.
                  </p>
                </div>
              </div>
        </div>
    </section>

    <section class="section" id="speedup">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full">
                    <h2 class="title is-4">Speedup: Can We Reduce LRM Computation Mid-Reasoning?</h2>
                </div>
            </div>
            
            <!-- Speedup Content -->
            <div class="columns is-centered">
                <div class="column is-full">
                  <ul style="list-style-type: disc; padding-left: 2rem; margin: 1rem 0 0.5rem 0;">
                    <li style="margin-bottom: 0.5rem;">Magistral & Qwen (Math): Achieve near “free-lunch” speedups — thinking faster mid-process with fewer tokens consumed.</li>
                    <li style="margin-bottom: 0;">GPT-OSS & Qwen (Coding): Tend to <strong>panic</strong> under pressure — up to a 25% performance drop from rushing to answer before finishing its first reasoning cycle.</li>
                  </ul>
                  <img src="static/images/figures_new/soft_interrupt_output_length.png" style="max-width: 100%; height: auto;">
                  
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    Complementary to prior work on efficient reasoning via pre-planning, we are the first to examine the efficacy of <b>on-the-fly speedup</b>. 
                    Interestingly, the speedup rate follows a <b>U-shaped curve</b> — pushing the model at the right moment can yield faster responses with minimal performance loss.
                  </p>
              
                  <p style="margin-top: 1rem; line-height: 1.6;">
                    However, some models like Qwen and GPT-OSS exhibit <b>panic answering</b>, especially on coding tasks. 
                    While performance drops are expected under acceleration, the ideal behavior should be a smooth drop than a complete collapse into rushed, low-quality answers.
                  </p>
                  
                  <div id="interactive-vis-container-panic" style="margin: 2rem 0;">
                    <!-- Content will be loaded here by JavaScript -->
                 </div>
                </div>
              </div>
        </div>
    </section>

    <section class="section" id="update-driven">
        <div class="container is-max-desktop">
          <div class="columns is-centered has-text-centered">
            <div class="column is-full">
              <h2 class="title is-4">How Do LRMs Behave Under Update-Driven Interruptions?</h2>
            </div>
          </div>
      
          <!-- (1) Update Prompting Subsection -->
          <div class="columns is-centered">
            <div class="column is-full">      
              <p>
                To simulate real-time context changes, we prompt the model with a system instruction
                explaining that updates will appear between <code>&lt;update&gt;...&lt;/update&gt;</code> tags,
                and then insert these updates mid-reasoning. This simple setup caused a noticeable performance drop across models.
              </p>
      
              <p>
                To mitigate this, we introduced a more natural baseline: <b>guided prompting</b> using the model’s own voice.
                Instead of a raw update tag, we phrase the update as if the model is reminding itself of the new information.
                This almost eliminates the <b>self-doubt</b> issue and significantly stabilizes performance,
                as shown in the chart below.
              </p>
              <p style="margin-top: 1rem; line-height: 1.6;">
                We revisit the main intervention experiments to study the trade-off between
                performance retention and output-length expansion after receiving information updates.
                In some cases, models maintain strong performance—even outperforming the
                “stop-and-redo” baseline. For example, GPT-OSS on <i>LiveCodeBench-v6</i> and
                Qwen on <i>GSM8k</i> preserve around <b>95%</b> of oracle accuracy with much lower computation cost.
                However, this efficiency remains inconsistent across other settings.
              </p>
              <img src="static/images/figures_new/intervene_acc.png" style="max-width: 100%; height: auto;">
      
              <p style="margin-top: 1rem; line-height: 1.6;">
                From the figure, we observe that:
                <br>(1) Guided prompts are highly effective but cannot fully prevent performance drops when updates arrive too late in the reasoning process.
                <br>(2) With guidance, Qwen and Magistral still struggle on harder benchmarks like <i>AIME 24/25</i> and <i>LiveCodeBench-v6</i>, especially in coding tasks where updates often conflict with starter code.
              </p>
      
              <p style="margin-top: 1rem; line-height: 1.6;">
                Since not all LRMs natively support multi-turn thinking, we cannot easily close a reasoning block,
                inject a user update, and reopen it. To validate this, we performed an ablation study simulating that setup,
                confirming that current LRMs remain fragile under such mid-thinking interruptions, performing worse than our guided prompting baseline.
              </p>
              
              <div id="interactive-vis-container-doubt" style="margin: 2rem 0;">
                <!-- Content will be loaded here by JavaScript -->
             </div>
      
            </div>
          </div>
        </div>
      </section>




    <!-- Acknowledgements Section -->
    <section class="section" id="acknowledgements">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-full">
                    <h2 class="title is-4">Acknowledgment</h2>
                </div>
            </div>
            <div class="columns is-centered">
                <div class="column is-full">
                    <p style="line-height: 1.6;">
                        We are deeply grateful to <a href="https://lisabdunlap.com/" target="_blank" rel="noopener">Lisa Dunlap</a> for her invaluable feedback and thoughtful discussions. We also thank <strong><a href="https://modal.com/" target="_blank" rel="noopener">Modal</a></strong> for supporting this work through their Academics Compute Grant. <a href="https://sky.cs.berkeley.edu/" target="_blank" rel="noopener">Sky Computing Lab</a> is supported by gifts from Accenture, AMD, Anyscale, Cisco, Google, IBM, Intel, Intesa Sanpaolo, Lambda, Lightspeed, Mibura, Microsoft, NVIDIA, Samsung SDS, and SAP. Authors, as part of their affiliation with UC Berkeley, were supported in part by the National Science Foundation, US Department of Defense, and/or the <a href="https://bair.berkeley.edu/" target="_blank" rel="noopener">Berkeley Artificial Intelligence Research (BAIR)</a> industrial alliance program, as well as gifts from Amazon.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!--BibTex citation -->
    <section class="section" id="BibTeX">
        <div class="container is-max-desktop content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3 class="title" style="margin-bottom: 0;">BibTeX</h3>
                <button id="copy-bibtex" class="button is-small is-light" style="border: 1px solid #ddd; background: #f8f9fa;">
                    <span class="icon is-small">
                        <i class="fas fa-copy"></i>
                    </span>
                    <span>Copy</span>
                </button>
            </div>
            <pre id="bibtex-content" style="position: relative; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 6px; padding: 1rem; margin: 0;"><code>@misc{wu2025interruptible,
  title={Are Large Reasoning Models Interruptible?},
  author={Wu, Tsung-Han and Miroyan, Mihran and Chan, David M and Darrell, Trevor and Norouzi, Narges and Gonzalez, Joseph E},
  note={Project page},
  year={2025}
}</code></pre>
        </div>
    </section>
    <!--End BibTex citation -->


    <footer class="footer">
        <div class="container">
            <div class="columns is-centered">
                <div class="column is-8">
                    <div class="content">

                        <p>
                            This page was built using the <a
                                href="https://github.com/eliahuhorwitz/Academic-project-page-template"
                                target="_blank">Academic Project Page Template</a> which was adopted from the <a
                                href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
                            You are free to borrow the of this website, we just ask that you link back to this page in
                            the footer. <br> This website is licensed under a <a rel="license"
                                href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
                                Commons Attribution-ShareAlike 4.0 International License</a>.
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Statcounter tracking code -->

    <!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

    <script>
        // Carousel functionality
        let currentSlide = 0;
        const totalSlides = 3;
        const images = [
            'static/images/answer_length.png',
            'static/images/answer_length.png', 
            'static/images/answer_length.png'
        ];
        const labels = ['Hard Interrupt → Reasoning Leakage', 'Speedup → Panic', 'Info Update → Self-doubt'];

        function updateCarousel() {
            const track = document.querySelector('.carousel-track');
            const dots = document.querySelectorAll('.pagination-dot');
            
            // Slide the track to show the current slide
            const leftPosition = -currentSlide * 850; // 850px is the width of each panel
            track.style.left = leftPosition + 'px';
            
            // Debug: log the position to ensure it's correct
            console.log(`Slide ${currentSlide + 1}: moving to position ${leftPosition}px`);
            
            // Update pagination dots
            dots.forEach((dot, index) => {
                if (index === currentSlide) {
                    dot.style.background = '#000';
                } else {
                    dot.style.background = '#ccc';
                }
            });
        }

        // Add event listeners to arrows
        document.querySelector('.carousel-arrow-left').addEventListener('click', () => {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateCarousel();
        });

        document.querySelector('.carousel-arrow-right').addEventListener('click', () => {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        });

        // Add event listeners to pagination dots
        document.querySelectorAll('.pagination-dot').forEach((dot, index) => {
            dot.addEventListener('click', () => {
                currentSlide = index;
                updateCarousel();
            });
        });

        // Auto-play functionality
        let autoPlayInterval;
        
        function startAutoPlay() {
            autoPlayInterval = setInterval(() => {
                currentSlide = (currentSlide + 1) % totalSlides;
                updateCarousel();
            }, 3000); // Change slide every 3 seconds
        }
        
        function stopAutoPlay() {
            clearInterval(autoPlayInterval);
        }
        
        // Pause auto-play when user interacts with carousel
        document.querySelector('.carousel-container').addEventListener('mouseenter', stopAutoPlay);
        document.querySelector('.carousel-container').addEventListener('mouseleave', startAutoPlay);
        
        // Initialize carousel
        updateCarousel();
        startAutoPlay();
        
        // Floating TOC functionality
        function updateActiveTOCLink() {
            const sections = document.querySelectorAll('section[id]');
            const tocLinks = document.querySelectorAll('.toc-link');
            
            let currentSection = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.scrollY >= (sectionTop - 200)) {
                    currentSection = section.getAttribute('id');
                }
            });
            
            tocLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + currentSection) {
                    link.classList.add('active');
                }
            });
        }
        
        // Update active link on scroll
        window.addEventListener('scroll', updateActiveTOCLink);
        
        // Smooth scrolling for TOC links
        document.querySelectorAll('.toc-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Initialize active link
        updateActiveTOCLink();
        
        // BibTeX copy functionality
        function setupBibtexCopy() {
            const copyButton = document.getElementById('copy-bibtex');
            if (!copyButton) {
                console.log('Copy button not found');
                return;
            }
            
            copyButton.addEventListener('click', function(e) {
                e.preventDefault();
                const bibtexText = `@misc{wu2025interruptible,
  title={Are Large Reasoning Models Interruptible?},
  author={Wu, Tsung-Han and Miroyan, Mihran and Chan, David M and Darrell, Trevor and Norouzi, Narges and Gonzalez, Joseph E},
  note={Project page},
  year={2025}
}`;
                
                // Try modern clipboard API first
                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(bibtexText).then(function() {
                        showCopySuccess(copyButton);
                    }).catch(function(err) {
                        console.error('Clipboard API failed:', err);
                        fallbackCopy(bibtexText, copyButton);
                    });
                } else {
                    // Fallback for older browsers
                    fallbackCopy(bibtexText, copyButton);
                }
            });
        }
        
        function showCopySuccess(button) {
            const originalHTML = button.innerHTML;
            button.innerHTML = '<span class="icon is-small"><i class="fas fa-check"></i></span><span>Copied!</span>';
            button.style.background = '#d4edda';
            button.style.borderColor = '#c3e6cb';
            button.style.color = '#155724';
            
            setTimeout(function() {
                button.innerHTML = originalHTML;
                button.style.background = '#f8f9fa';
                button.style.borderColor = '#ddd';
                button.style.color = '';
            }, 2000);
        }
        
        function fallbackCopy(text, button) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopySuccess(button);
            } catch (err) {
                console.error('Fallback copy failed:', err);
                alert('Failed to copy. Please select and copy manually.');
            }
            
            document.body.removeChild(textArea);
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupBibtexCopy);
        } else {
            setupBibtexCopy();
        }
        
        // Interactive Examples functionality
        let interactiveProblems = [];
        let currentInteractiveProblemIndex = 0;
        
        // Separate variables for each container
        let interactiveProblemsLeakage = [];
        let currentInteractiveProblemIndexLeakage = 0;
        let interactiveProblemsPanic = [];
        let currentInteractiveProblemIndexPanic = 0;
        let interactiveProblemsDoubt = [];
        let currentInteractiveProblemIndexDoubt = 0;

        function escapeHTML(str = "") {
            return String(str).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
        }

        function escapeAttribute(str = "") {
            return String(str)
                .replace(/&/g, "&amp;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#39;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;");
        }

        function truncate(text = "", limit = 96) {
            const base = String(text);
            return base.length > limit ? base.slice(0, limit).trim() + "…" : base;
        }

        function slugify(text = "model") {
            return String(text).toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g, "") || "model";
        }

        function formatPlainText(value = "") {
            const tokens = tokenizePlainText(String(value));
            return tokens.map(renderPlainToken).join("");
        }

        function tokenizePlainText(input) {
            const tokens = [];
            let idx = 0;
            let buffer = "";

            const flushBuffer = () => {
                if (buffer) {
                    tokens.push({ type: "text", content: buffer });
                    buffer = "";
                }
            };

            while (idx < input.length) {
                if (input.startsWith("```", idx)) {
                    const fenceEnd = input.indexOf("```", idx + 3);
                    if (fenceEnd === -1) {
                        buffer += input.slice(idx);
                        break;
                    }

                    flushBuffer();

                    let lang = "";
                    let contentStart = idx + 3;
                    const newlineIdx = input.indexOf("\n", idx + 3);
                    if (newlineIdx !== -1 && newlineIdx < fenceEnd) {
                        lang = input.slice(idx + 3, newlineIdx).trim();
                        contentStart = newlineIdx + 1;
                    }
                    const content = input.slice(contentStart, fenceEnd);
                    tokens.push({ type: "codeblock", lang, content });
                    idx = fenceEnd + 3;
                    continue;
                }

                if (input.startsWith("**", idx)) {
                    const end = input.indexOf("**", idx + 2);
                    if (end === -1) {
                        buffer += input[idx];
                        idx += 1;
                    } else {
                        flushBuffer();
                        const content = input.slice(idx + 2, end);
                        tokens.push({ type: "bold", content });
                        idx = end + 2;
                    }
                    continue;
                }

                if (input[idx] === "`") {
                    const end = input.indexOf("`", idx + 1);
                    if (end === -1) {
                        buffer += input[idx];
                        idx += 1;
                    } else {
                        flushBuffer();
                        const content = input.slice(idx + 1, end);
                        tokens.push({ type: "inline", content });
                        idx = end + 1;
                    }
                    continue;
                }

                buffer += input[idx];
                idx += 1;
            }

            if (idx >= input.length && buffer) {
                tokens.push({ type: "text", content: buffer });
            }

            return tokens;
        }

        function renderPlainToken(token) {
            switch (token.type) {
                case "text":
                    return escapeHTML(token.content).replace(/\n/g, "<br>");
                case "bold":
                    return `<strong>${formatPlainText(token.content)}</strong>`;
                case "inline": {
                    const trimmed = token.content.trim();
                    if (/^latex[:\s]/i.test(trimmed)) {
                        const latexContent = trimmed.replace(/^latex[:\s]*/i, "");
                        return wrapLatex(latexContent);
                    }
                    return `<code class="inline-code">${escapeHTML(token.content)}</code>`;
                }
                case "codeblock": {
                    const lang = (token.lang || "").trim().toLowerCase();
                    if (lang === "latex" || lang === "math" || lang === "tex") {
                        return wrapLatex(token.content.trim());
                    }
                    const languageClass = lang ? `language-${escapeHTML(lang)}` : "language-plaintext";
                    return `<pre class="code-block"><code class="${languageClass}">${escapeHTML(token.content)}</code></pre>`;
                }
                default:
                    return "";
            }
        }

        function wrapLatex(value = "") {
            const trimmed = value.trim();
            if (!trimmed) return "";
            const needsBlock = trimmed.includes("\n") || trimmed.includes("\\begin");
            return needsBlock ? `<span class="mathjax-latex">\\[${trimmed}\\]</span>` : `<span class="mathjax-latex">\\(${trimmed}\\)</span>`;
        }

        function renderRich(content) {
            if (!content) return "";
            if (typeof content === "string") {
                return formatPlainText(content);
            }
            const format = content.format || "text";
            const value = content.value ?? "";
            if (!value) return "";
            if (format === "latex") return wrapLatex(String(value));
            if (format === "html") return String(value);
            return formatPlainText(value);
        }

        function normalizeContent(content, fallbackValue = "") {
            if (!content && !fallbackValue) {
                return null;
            }
            if (typeof content === "string") {
                return { format: "text", value: content };
            }
            if (content && typeof content === "object") {
                const value = content.value ?? fallbackValue;
                return { format: content.format || "text", value };
            }
            return { format: "text", value: fallbackValue };
        }

        function getContentString(raw, fallbackValue = "") {
            if (raw == null) {
                return fallbackValue;
            }
            if (typeof raw === "string") {
                return raw;
            }
            if (typeof raw === "object") {
                const value = raw.value ?? fallbackValue;
                return typeof value === "string" ? value : String(value ?? "");
            }
            return String(raw);
        }

        function countLines(text = "") {
            if (!text) return 0;
            const normalized = String(text).replace(/\r\n/g, "\n");
            let lines = normalized.split("\n").length;
            if (normalized.endsWith("\n")) {
                lines -= 1;
            }
            if (lines < 1) {
                lines = 1;
            }
            return lines;
        }

        function extractQuestion(problem) {
            const question = problem.question;
            const fallbackUrl = problem && typeof problem === "object" ? (problem.url || problem.href || null) : null;
            if (!question) {
                return { title: "Untitled Problem", content: null, url: fallbackUrl };
            }
            if (typeof question === "string") {
                return { title: question, content: { format: "text", value: question }, url: fallbackUrl };
            }
            const title = question.title || "Untitled Problem";
            const content = normalizeContent(question.content, title);
            const url = question.url || question.href || fallbackUrl || null;
            return { title, content, url };
        }

        async function loadInteractiveProblems() {
            try {
                const container = document.getElementById('interactive-viz-container');
                if (!container) return;
                
                container.innerHTML = '<div class="interactive-viz"><div class="wrapper"><div class="header"><h1>Loading problems…</h1></div></div></div>';
                
                const response = await fetch("./interactive_examples_data.json", { cache: "no-cache" });
                if (!response.ok) {
                    throw new Error(`Failed to load data (${response.status})`);
                }
                const payload = await response.json();
                interactiveProblems = Array.isArray(payload.problems) ? payload.problems : [];
                if (!interactiveProblems.length) {
                    container.innerHTML = '<div class="interactive-viz"><div class="wrapper"><div class="header"><h1>No problems available.</h1></div></div></div>';
                    return;
                }
                currentInteractiveProblemIndex = 0;
                renderInteractiveProblem();
            } catch (error) {
                console.error(error);
                const container = document.getElementById('interactive-viz-container');
                if (container) {
                    container.innerHTML = `<div class="interactive-viz"><div class="wrapper"><div class="header"><h1>Failed to load examples.</h1></div></div></div>`;
                }
            }
        }

        // Leakage container functions
        async function loadInteractiveProblemsLeakage() {
            try {
                const container = document.getElementById('interactive-vis-container-leakage');
                if (!container) return;
                
                container.innerHTML = '<div class="interactive-viz-leakage"><div class="wrapper"><div class="header"><h1>Loading problems…</h1></div></div></div>';
                
                const response = await fetch("./interactive_examples_data.json", { cache: "no-cache" });
                if (!response.ok) {
                    throw new Error(`Failed to load data (${response.status})`);
                }
                const payload = await response.json();
                interactiveProblemsLeakage = Array.isArray(payload.problems) ? payload.problems : [];
                if (!interactiveProblemsLeakage.length) {
                    container.innerHTML = '<div class="interactive-viz-leakage"><div class="wrapper"><div class="header"><h1>No problems available.</h1></div></div></div>';
                    return;
                }
                currentInteractiveProblemIndexLeakage = 0;
                renderInteractiveProblemLeakage();
            } catch (error) {
                console.error(error);
                const container = document.getElementById('interactive-vis-container-leakage');
                if (container) {
                    container.innerHTML = `<div class="interactive-viz-leakage"><div class="wrapper"><div class="header"><h1>Failed to load examples.</h1></div></div></div>`;
                }
            }
        }

        // Panic container functions
        async function loadInteractiveProblemsPanic() {
            try {
                const container = document.getElementById('interactive-vis-container-panic');
                if (!container) return;
                
                container.innerHTML = '<div class="interactive-viz-panic"><div class="wrapper"><div class="header"><h1>Loading problems…</h1></div></div></div>';
                
                const response = await fetch("./interactive_examples_data.json", { cache: "no-cache" });
                if (!response.ok) {
                    throw new Error(`Failed to load data (${response.status})`);
                }
                const payload = await response.json();
                interactiveProblemsPanic = Array.isArray(payload.problems) ? payload.problems : [];
                if (!interactiveProblemsPanic.length) {
                    container.innerHTML = '<div class="interactive-viz-panic"><div class="wrapper"><div class="header"><h1>No problems available.</h1></div></div></div>';
                    return;
                }
                currentInteractiveProblemIndexPanic = 0;
                renderInteractiveProblemPanic();
            } catch (error) {
                console.error(error);
                const container = document.getElementById('interactive-vis-container-panic');
                if (container) {
                    container.innerHTML = `<div class="interactive-viz-panic"><div class="wrapper"><div class="header"><h1>Failed to load examples.</h1></div></div></div>`;
                }
            }
        }

        // Doubt container functions
        async function loadInteractiveProblemsDoubt() {
            try {
                const container = document.getElementById('interactive-vis-container-doubt');
                if (!container) return;
                
                container.innerHTML = '<div class="interactive-viz-doubt"><div class="wrapper"><div class="header"><h1>Loading problems…</h1></div></div></div>';
                
                const response = await fetch("./interactive_examples_data.json", { cache: "no-cache" });
                if (!response.ok) {
                    throw new Error(`Failed to load data (${response.status})`);
                }
                const payload = await response.json();
                interactiveProblemsDoubt = Array.isArray(payload.problems) ? payload.problems : [];
                if (!interactiveProblemsDoubt.length) {
                    container.innerHTML = '<div class="interactive-viz-doubt"><div class="wrapper"><div class="header"><h1>No problems available.</h1></div></div></div>';
                    return;
                }
                currentInteractiveProblemIndexDoubt = 0;
                renderInteractiveProblemDoubt();
            } catch (error) {
                console.error(error);
                const container = document.getElementById('interactive-vis-container-doubt');
                if (container) {
                    container.innerHTML = `<div class="interactive-viz-doubt"><div class="wrapper"><div class="header"><h1>Failed to load examples.</h1></div></div></div>`;
                }
            }
        }

        function renderInteractiveProblem() {
            if (!interactiveProblems.length) {
                return;
            }
            const problem = interactiveProblems[currentInteractiveProblemIndex];
            const { title, content, url: questionUrl } = extractQuestion(problem);
            
            const container = document.getElementById('interactive-viz-container');
            if (!container) return;
            
            const questionHTML = renderRich(content);
            const encodedQuestion = encodeURIComponent(questionHTML || "");
            const questionTitleHTML = questionUrl
                ? `<a href="${escapeAttribute(questionUrl)}" target="_blank" rel="noopener">${escapeHTML(title)}</a>`
                : escapeHTML(title);
            const headerTitleHTML = "Examples of Reasoning Leakage";
            const headerActions = `
                <div class="header-actions">
                    <button id="interactive-next-problem" title="Cycle through the next problem">Next problem ▶</button>
                </div>
            `;
            
            container.innerHTML = `
                <div class="interactive-viz">
                    <div class="wrapper">
                        <div class="header">
                            <h1 id="interactive-question-title">${headerTitleHTML}</h1>
                            ${headerActions}
                        </div>
                        <div class="question-details" id="interactive-question-details">
                            <h2 class="question-preview-title">${questionTitleHTML}</h2>
                            <div class="question-content">${questionHTML}</div>
                            <button 
                                class="view-full-context-btn" 
                                data-type="question" 
                                data-title="${encodeURIComponent(title)}"
                                data-content="${encodedQuestion}">
                                View Full Problem
                            </button>
                        </div>
                        <div class="panels-container" id="interactive-panels-container"></div>
                    </div>
                </div>
            `;
            
            const questionDetailsEl = document.getElementById('interactive-question-details');
            const viewFullQuestionBtn = questionDetailsEl ? questionDetailsEl.querySelector('.view-full-context-btn') : null;
            const panelsContainerEl = document.getElementById('interactive-panels-container');
            const nextProblemBtn = document.getElementById('interactive-next-problem');

            renderInteractivePanels(problem, panelsContainerEl);
            if (questionDetailsEl) {
                typesetMath(questionDetailsEl);
            }
            
            const updateQuestionClamp = () => {
                if (!questionDetailsEl) return;
                const isOverflowing = Math.ceil(questionDetailsEl.scrollHeight - questionDetailsEl.clientHeight) > 4;
                questionDetailsEl.classList.toggle('is-clamped', isOverflowing);
            };
            
            updateQuestionClamp();
            setTimeout(updateQuestionClamp, 200);
            setTimeout(updateQuestionClamp, 600);
            requestAnimationFrame(updateQuestionClamp);
            
            if (viewFullQuestionBtn) {
                viewFullQuestionBtn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const contentValue = viewFullQuestionBtn.dataset.content || "";
                    if (!contentValue) return;
                    const encodedTitle = viewFullQuestionBtn.dataset.title;
                    const titleValue = encodedTitle ? decodeURIComponent(encodedTitle) : title;
                    showSeparateView(contentValue, viewFullQuestionBtn.dataset.type || "question", `Full context - ${titleValue}`);
                });
            }
            
            nextProblemBtn.addEventListener("click", () => {
                currentInteractiveProblemIndex = (currentInteractiveProblemIndex + 1) % interactiveProblems.length;
                renderInteractiveProblem();
            });
        }

        // Leakage render function
        function renderInteractiveProblemLeakage() {
            if (!interactiveProblemsLeakage.length) {
                return;
            }
            const problem = interactiveProblemsLeakage[currentInteractiveProblemIndexLeakage];
            const { title, content, url: questionUrl } = extractQuestion(problem);
            
            const container = document.getElementById('interactive-vis-container-leakage');
            if (!container) return;
            
            const questionHTML = renderRich(content);
            const encodedQuestion = encodeURIComponent(questionHTML || "");
            const questionTitleHTML = questionUrl
                ? `<a href="${escapeAttribute(questionUrl)}" target="_blank" rel="noopener">${escapeHTML(title)}</a>`
                : escapeHTML(title);
            const headerTitleHTML = "Examples of Reasoning Leakage";
            const headerActions = `
                <div class="header-actions">
                    <button id="interactive-next-problem-leakage" title="Cycle through the next problem">Next problem ▶</button>
                </div>
            `;
            
            container.innerHTML = `
                <div class="interactive-viz-leakage">
                    <div class="wrapper">
                        <div class="header">
                            <h1 id="interactive-question-title-leakage">${headerTitleHTML}</h1>
                            ${headerActions}
                        </div>
                        <div class="question-details" id="interactive-question-details-leakage">
                            <h2 class="question-preview-title">${questionTitleHTML}</h2>
                            <div class="question-content">${questionHTML}</div>
                            <button 
                                class="view-full-context-btn" 
                                data-type="question" 
                                data-title="${encodeURIComponent(title)}"
                                data-content="${encodedQuestion}">
                                View Full Problem
                            </button>
                        </div>
                        <div class="panels-container" id="interactive-panels-container-leakage"></div>
                    </div>
                </div>
            `;
            
            const questionDetailsEl = document.getElementById('interactive-question-details-leakage');
            const viewFullQuestionBtn = questionDetailsEl ? questionDetailsEl.querySelector('.view-full-context-btn') : null;
            const panelsContainerEl = document.getElementById('interactive-panels-container-leakage');
            const nextProblemBtn = document.getElementById('interactive-next-problem-leakage');

            renderInteractivePanelsLeakage(problem, panelsContainerEl);
            if (questionDetailsEl) {
                typesetMath(questionDetailsEl);
            }
            
            const updateQuestionClamp = () => {
                if (!questionDetailsEl) return;
                const isOverflowing = Math.ceil(questionDetailsEl.scrollHeight - questionDetailsEl.clientHeight) > 4;
                questionDetailsEl.classList.toggle('is-clamped', isOverflowing);
            };
            
            updateQuestionClamp();
            setTimeout(updateQuestionClamp, 200);
            setTimeout(updateQuestionClamp, 600);
            requestAnimationFrame(updateQuestionClamp);
            
            if (viewFullQuestionBtn) {
                viewFullQuestionBtn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const contentValue = viewFullQuestionBtn.dataset.content || "";
                    if (!contentValue) return;
                    const encodedTitle = viewFullQuestionBtn.dataset.title;
                    const titleValue = encodedTitle ? decodeURIComponent(encodedTitle) : title;
                    showSeparateViewLeakage(contentValue, viewFullQuestionBtn.dataset.type || "question", `Full context - ${titleValue}`);
                });
            }
            
            nextProblemBtn.addEventListener("click", () => {
                currentInteractiveProblemIndexLeakage = (currentInteractiveProblemIndexLeakage + 1) % interactiveProblemsLeakage.length;
                renderInteractiveProblemLeakage();
            });
        }

        // Panic render function
        function renderInteractiveProblemPanic() {
            if (!interactiveProblemsPanic.length) {
                return;
            }
            const problem = interactiveProblemsPanic[currentInteractiveProblemIndexPanic];
            const { title, content, url: questionUrl } = extractQuestion(problem);
            
            const container = document.getElementById('interactive-vis-container-panic');
            if (!container) return;
            
            const questionHTML = renderRich(content);
            const encodedQuestion = encodeURIComponent(questionHTML || "");
            const questionTitleHTML = questionUrl
                ? `<a href="${escapeAttribute(questionUrl)}" target="_blank" rel="noopener">${escapeHTML(title)}</a>`
                : escapeHTML(title);
            const headerTitleHTML = "Examples of Panic Answering";
            const headerActions = `
                <div class="header-actions">
                    <button id="interactive-next-problem-panic" title="Cycle through the next problem">Next problem ▶</button>
                </div>
            `;
            
            container.innerHTML = `
                <div class="interactive-viz-panic">
                    <div class="wrapper">
                        <div class="header">
                            <h1 id="interactive-question-title-panic">${headerTitleHTML}</h1>
                            ${headerActions}
                        </div>
                        <div class="question-details" id="interactive-question-details-panic">
                            <h2 class="question-preview-title">${questionTitleHTML}</h2>
                            <div class="question-content">${questionHTML}</div>
                            <button 
                                class="view-full-context-btn" 
                                data-type="question" 
                                data-title="${encodeURIComponent(title)}"
                                data-content="${encodedQuestion}">
                                View Full Problem
                            </button>
                        </div>
                        <div class="panels-container" id="interactive-panels-container-panic"></div>
                    </div>
                </div>
            `;
            
            const questionDetailsEl = document.getElementById('interactive-question-details-panic');
            const viewFullQuestionBtn = questionDetailsEl ? questionDetailsEl.querySelector('.view-full-context-btn') : null;
            const panelsContainerEl = document.getElementById('interactive-panels-container-panic');
            const nextProblemBtn = document.getElementById('interactive-next-problem-panic');

            renderInteractivePanelsPanic(problem, panelsContainerEl);
            if (questionDetailsEl) {
                typesetMath(questionDetailsEl);
            }
            
            const updateQuestionClamp = () => {
                if (!questionDetailsEl) return;
                const isOverflowing = Math.ceil(questionDetailsEl.scrollHeight - questionDetailsEl.clientHeight) > 4;
                questionDetailsEl.classList.toggle('is-clamped', isOverflowing);
            };
            
            updateQuestionClamp();
            setTimeout(updateQuestionClamp, 200);
            setTimeout(updateQuestionClamp, 600);
            requestAnimationFrame(updateQuestionClamp);
            
            if (viewFullQuestionBtn) {
                viewFullQuestionBtn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const contentValue = viewFullQuestionBtn.dataset.content || "";
                    if (!contentValue) return;
                    const encodedTitle = viewFullQuestionBtn.dataset.title;
                    const titleValue = encodedTitle ? decodeURIComponent(encodedTitle) : title;
                    showSeparateViewPanic(contentValue, viewFullQuestionBtn.dataset.type || "question", `Full context - ${titleValue}`);
                });
            }
            
            nextProblemBtn.addEventListener("click", () => {
                currentInteractiveProblemIndexPanic = (currentInteractiveProblemIndexPanic + 1) % interactiveProblemsPanic.length;
                renderInteractiveProblemPanic();
            });
        }

        // Doubt render function
        function renderInteractiveProblemDoubt() {
            if (!interactiveProblemsDoubt.length) {
                return;
            }
            const problem = interactiveProblemsDoubt[currentInteractiveProblemIndexDoubt];
            const { title, content, url: questionUrl } = extractQuestion(problem);
            
            const container = document.getElementById('interactive-vis-container-doubt');
            if (!container) return;
            
            const questionHTML = renderRich(content);
            const encodedQuestion = encodeURIComponent(questionHTML || "");
            const questionTitleHTML = questionUrl
                ? `<a href="${escapeAttribute(questionUrl)}" target="_blank" rel="noopener">${escapeHTML(title)}</a>`
                : escapeHTML(title);
            const headerTitleHTML = "Examples of Self-Doubt";
            const headerActions = `
                <div class="header-actions">
                    <button id="interactive-next-problem-doubt" title="Cycle through the next problem">Next problem ▶</button>
                </div>
            `;
            
            container.innerHTML = `
                <div class="interactive-viz-doubt">
                    <div class="wrapper">
                        <div class="header">
                            <h1 id="interactive-question-title-doubt">${headerTitleHTML}</h1>
                            ${headerActions}
                        </div>
                        <div class="question-details" id="interactive-question-details-doubt">
                            <h2 class="question-preview-title">${questionTitleHTML}</h2>
                            <div class="question-content">${questionHTML}</div>
                            <button 
                                class="view-full-context-btn" 
                                data-type="question" 
                                data-title="${encodeURIComponent(title)}"
                                data-content="${encodedQuestion}">
                                View Full Problem
                            </button>
                        </div>
                        <div class="panels-container" id="interactive-panels-container-doubt"></div>
                    </div>
                </div>
            `;
            
            const questionDetailsEl = document.getElementById('interactive-question-details-doubt');
            const viewFullQuestionBtn = questionDetailsEl ? questionDetailsEl.querySelector('.view-full-context-btn') : null;
            const panelsContainerEl = document.getElementById('interactive-panels-container-doubt');
            const nextProblemBtn = document.getElementById('interactive-next-problem-doubt');

            renderInteractivePanelsDoubt(problem, panelsContainerEl);
            if (questionDetailsEl) {
                typesetMath(questionDetailsEl);
            }
            
            const updateQuestionClamp = () => {
                if (!questionDetailsEl) return;
                const isOverflowing = Math.ceil(questionDetailsEl.scrollHeight - questionDetailsEl.clientHeight) > 4;
                questionDetailsEl.classList.toggle('is-clamped', isOverflowing);
            };
            
            updateQuestionClamp();
            setTimeout(updateQuestionClamp, 200);
            setTimeout(updateQuestionClamp, 600);
            requestAnimationFrame(updateQuestionClamp);
            
            if (viewFullQuestionBtn) {
                viewFullQuestionBtn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const contentValue = viewFullQuestionBtn.dataset.content || "";
                    if (!contentValue) return;
                    const encodedTitle = viewFullQuestionBtn.dataset.title;
                    const titleValue = encodedTitle ? decodeURIComponent(encodedTitle) : title;
                    showSeparateViewDoubt(contentValue, viewFullQuestionBtn.dataset.type || "question", `Full context - ${titleValue}`);
                });
            }
            
            nextProblemBtn.addEventListener("click", () => {
                currentInteractiveProblemIndexDoubt = (currentInteractiveProblemIndexDoubt + 1) % interactiveProblemsDoubt.length;
                renderInteractiveProblemDoubt();
            });
        }


        function renderInteractivePanels(problem, panelsContainerEl) {
            const model = problem && typeof problem === "object" ? problem.model : null;
            if (!model || typeof model !== "object") {
                panelsContainerEl.innerHTML = '<div class="empty-state">No model data available for this problem.</div>';
                typesetMath();
                return;
            }

            const modelName = model.name || "Model";
            const modelLink = model && typeof model === "object" ? (model.url || model.href || null) : null;
            const baseId = `${problem.id || "problem"}-${slugify(modelName)}`;
            const logoSrc = model.logo ? escapeAttribute(model.logo) : null;
            const modelHeading = modelLink
                ? `<a href="${escapeAttribute(modelLink)}" target="_blank" rel="noopener">${escapeHTML(modelName)}</a>`
                : escapeHTML(modelName);

            panelsContainerEl.innerHTML = `
                <div class="model-header">
                    ${logoSrc ? `<img src="${logoSrc}" alt="${escapeAttribute(modelName)} logo">` : ""}
                    <h2>${modelHeading}</h2>
                </div>
                <div class="model-panels">
                    ${["oracle", "interrupt"].map(stage => {
                        const stageData = model[stage] || {};
                        const stageLabel = stageData.label || (stage === "oracle" ? "Full Thinking" : "Hard Interrupt @0.3");
                        const bodyLabel = stage === "oracle" ? "Oracle Output" : "Interrupt Output";
                        const renderedAnswer = stageData.answer ? renderRich(stageData.answer) : "";
                        const renderedFinal = stageData.final ? renderRich(stageData.final) : "";
                        const renderedReasoning = stageData.reasoning ? renderRich(stageData.reasoning) : "";
                        const codeLineCount = stageData.code ? countLines(stageData.code) : 0;
                        const answerLineCount = stageData.answer ? countLines(getContentString(stageData.answer)) : 0;
                        const codeLineLabel = codeLineCount > 0 ? `<p class="answer-line-count">Answer section: ${codeLineCount} LINES</p>` : "";
                        const answerLineLabel = answerLineCount > 0 ? `<p class="answer-line-count">Answer section: ${answerLineCount} LINES</p>` : "";
                        const reasoningSection = renderedReasoning ? `
                            <button class="view-reasoning-btn" data-content="${encodeURIComponent(renderedReasoning)}" data-title="Reasoning - ${stageLabel}">View reasoning</button>
                        ` : "";
                        const codeSection = stageData.code ? `
                            <div class="content-container">
                                ${codeLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(stageData.code)}" data-type="code" data-title="Code - ${stageLabel}">View separately</button>
                                <pre class="code-block"><code class="language-python">${escapeHTML(stageData.code)}</code></pre>
                            </div>` : "";
                        const answerSection = stageData.answer ? `
                            <div class="content-container">
                                ${answerLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedAnswer)}" data-type="math" data-title="Math Answer - ${stageLabel}">View separately</button>
                                <div class="math-answer">${renderedAnswer}</div>
                            </div>` : "";
                        const finalSection = stageData.final ? `
                            <div class="content-container">
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedFinal)}" data-type="final" data-title="Final Answer - ${stageLabel}">View separately</button>
                                <div class="final-answer">${renderedFinal}</div>
                            </div>` : "";
                        return `
                            <section class="panel">
                                <h3>${bodyLabel} &mdash; ${stageLabel}</h3>
                                ${reasoningSection}
                                ${codeSection}
                                ${answerSection}
                                ${finalSection}
                            </section>
                        `;
                    }).join("")}
                </div>
            `;

            panelsContainerEl.querySelectorAll("pre code").forEach(block => {
                if (window.hljs) {
                    // Force Python syntax highlighting
                    block.className = 'language-python';
                    hljs.highlightElement(block);
                    // Apply line numbers after highlighting
                    applyLineNumbers(block);
                }
            });

            panelsContainerEl.querySelectorAll(".view-reasoning-btn").forEach(btn => {
                btn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const encoded = btn.dataset.content || "";
                    if (!encoded) return;
                    const title = btn.dataset.title || "Reasoning";
                    showSeparateView(encoded, "reasoning", title);
                });
            });

            typesetMath();
            
            // Add event listeners for view separate buttons
            panelsContainerEl.querySelectorAll(".view-separate-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    e.preventDefault();
                    const content = btn.dataset.content;
                    const type = btn.dataset.type;
                    const title = btn.dataset.title;
                    showSeparateView(content, type, title);
                });
            });
        }

        // Leakage panels function
        function renderInteractivePanelsLeakage(problem, panelsContainerEl) {
            const model = problem && typeof problem === "object" ? problem.model : null;
            if (!model || typeof model !== "object") {
                panelsContainerEl.innerHTML = '<div class="empty-state">No model data available for this problem.</div>';
                typesetMath();
                return;
            }

            const modelName = model.name || "Model";
            const modelLink = model && typeof model === "object" ? (model.url || model.href || null) : null;
            const baseId = `${problem.id || "problem"}-${slugify(modelName)}`;
            const logoSrc = model.logo ? escapeAttribute(model.logo) : null;
            const modelHeading = modelLink
                ? `<a href="${escapeAttribute(modelLink)}" target="_blank" rel="noopener">${escapeHTML(modelName)}</a>`
                : escapeHTML(modelName);

            panelsContainerEl.innerHTML = `
                <div class="model-header">
                    ${logoSrc ? `<img src="${logoSrc}" alt="${escapeAttribute(modelName)} logo">` : ""}
                    <h2>${modelHeading}</h2>
                </div>
                <div class="model-panels">
                    ${["oracle", "interrupt"].map(stage => {
                        const stageData = model[stage] || {};
                        const stageLabel = stageData.label || (stage === "oracle" ? "Full Thinking" : "Hard Interrupt @0.3");
                        const bodyLabel = stage === "oracle" ? "Oracle Output" : "Interrupt Output";
                        const renderedAnswer = stageData.answer ? renderRich(stageData.answer) : "";
                        const renderedFinal = stageData.final ? renderRich(stageData.final) : "";
                        const renderedReasoning = stageData.reasoning ? renderRich(stageData.reasoning) : "";
                        const codeLineCount = stageData.code ? countLines(stageData.code) : 0;
                        const answerLineCount = stageData.answer ? countLines(getContentString(stageData.answer)) : 0;
                        const codeLineLabel = codeLineCount > 0 ? `<p class="answer-line-count">Answer section: ${codeLineCount} LINES</p>` : "";
                        const answerLineLabel = answerLineCount > 0 ? `<p class="answer-line-count">Answer section: ${answerLineCount} LINES</p>` : "";
                        const reasoningSection = renderedReasoning ? `
                            <button class="view-reasoning-btn" data-content="${encodeURIComponent(renderedReasoning)}" data-title="Reasoning - ${stageLabel}">View reasoning</button>
                        ` : "";
                        const codeSection = stageData.code ? `
                            <div class="content-container">
                                ${codeLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(stageData.code)}" data-type="code" data-title="Code - ${stageLabel}">View separately</button>
                                <pre class="code-block"><code class="language-python">${escapeHTML(stageData.code)}</code></pre>
                            </div>` : "";
                        const answerSection = stageData.answer ? `
                            <div class="content-container">
                                ${answerLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedAnswer)}" data-type="math" data-title="Math Answer - ${stageLabel}">View separately</button>
                                <div class="math-answer">${renderedAnswer}</div>
                            </div>` : "";
                        const finalSection = stageData.final ? `
                            <div class="content-container">
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedFinal)}" data-type="final" data-title="Final Answer - ${stageLabel}">View separately</button>
                                <div class="final-answer">${renderedFinal}</div>
                            </div>` : "";
                        return `
                            <section class="panel">
                                <h3>${bodyLabel} &mdash; ${stageLabel}</h3>
                                ${reasoningSection}
                                ${codeSection}
                                ${answerSection}
                                ${finalSection}
                            </section>
                        `;
                    }).join("")}
                </div>
            `;

            panelsContainerEl.querySelectorAll("pre code").forEach(block => {
                if (window.hljs) {
                    // Force Python syntax highlighting
                    block.className = 'language-python';
                    hljs.highlightElement(block);
                    // Apply line numbers after highlighting
                    applyLineNumbers(block);
                }
            });

            panelsContainerEl.querySelectorAll(".view-reasoning-btn").forEach(btn => {
                btn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const encoded = btn.dataset.content || "";
                    if (!encoded) return;
                    const title = btn.dataset.title || "Reasoning";
                    showSeparateViewLeakage(encoded, "reasoning", title);
                });
            });

            typesetMath();
            
            // Add event listeners for view separate buttons
            panelsContainerEl.querySelectorAll(".view-separate-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    e.preventDefault();
                    const content = btn.dataset.content;
                    const type = btn.dataset.type;
                    const title = btn.dataset.title;
                    showSeparateViewLeakage(content, type, title);
                });
            });
        }

        // Panic panels function
        function renderInteractivePanelsPanic(problem, panelsContainerEl) {
            const model = problem && typeof problem === "object" ? problem.model : null;
            if (!model || typeof model !== "object") {
                panelsContainerEl.innerHTML = '<div class="empty-state">No model data available for this problem.</div>';
                typesetMath();
                return;
            }

            const modelName = model.name || "Model";
            const modelLink = model && typeof model === "object" ? (model.url || model.href || null) : null;
            const baseId = `${problem.id || "problem"}-${slugify(modelName)}`;
            const logoSrc = model.logo ? escapeAttribute(model.logo) : null;
            const modelHeading = modelLink
                ? `<a href="${escapeAttribute(modelLink)}" target="_blank" rel="noopener">${escapeHTML(modelName)}</a>`
                : escapeHTML(modelName);

            panelsContainerEl.innerHTML = `
                <div class="model-header">
                    ${logoSrc ? `<img src="${logoSrc}" alt="${escapeAttribute(modelName)} logo">` : ""}
                    <h2>${modelHeading}</h2>
                </div>
                <div class="model-panels">
                    ${["oracle", "interrupt"].map(stage => {
                        const stageData = model[stage] || {};
                        const stageLabel = stageData.label || (stage === "oracle" ? "Full Thinking" : "Speedup @0.3");
                        const bodyLabel = stage === "oracle" ? "Oracle Output" : "Speedup Output";
                        const renderedAnswer = stageData.answer ? renderRich(stageData.answer) : "";
                        const renderedFinal = stageData.final ? renderRich(stageData.final) : "";
                        const renderedReasoning = stageData.reasoning ? renderRich(stageData.reasoning) : "";
                        const codeLineCount = stageData.code ? countLines(stageData.code) : 0;
                        const answerLineCount = stageData.answer ? countLines(getContentString(stageData.answer)) : 0;
                        const codeLineLabel = codeLineCount > 0 ? `<p class="answer-line-count">Answer section: ${codeLineCount} LINES</p>` : "";
                        const answerLineLabel = answerLineCount > 0 ? `<p class="answer-line-count">Answer section: ${answerLineCount} LINES</p>` : "";
                        const reasoningSection = renderedReasoning ? `
                            <button class="view-reasoning-btn" data-content="${encodeURIComponent(renderedReasoning)}" data-title="Reasoning - ${stageLabel}">View reasoning</button>
                        ` : "";
                        const codeSection = stageData.code ? `
                            <div class="content-container">
                                ${codeLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(stageData.code)}" data-type="code" data-title="Code - ${stageLabel}">View separately</button>
                                <pre class="code-block"><code class="language-python">${escapeHTML(stageData.code)}</code></pre>
                            </div>` : "";
                        const answerSection = stageData.answer ? `
                            <div class="content-container">
                                ${answerLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedAnswer)}" data-type="math" data-title="Math Answer - ${stageLabel}">View separately</button>
                                <div class="math-answer">${renderedAnswer}</div>
                            </div>` : "";
                        const finalSection = stageData.final ? `
                            <div class="content-container">
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedFinal)}" data-type="final" data-title="Final Answer - ${stageLabel}">View separately</button>
                                <div class="final-answer">${renderedFinal}</div>
                            </div>` : "";
                        return `
                            <section class="panel">
                                <h3>${bodyLabel} &mdash; ${stageLabel}</h3>
                                ${reasoningSection}
                                ${codeSection}
                                ${answerSection}
                                ${finalSection}
                            </section>
                        `;
                    }).join("")}
                </div>
            `;

            panelsContainerEl.querySelectorAll("pre code").forEach(block => {
                if (window.hljs) {
                    // Force Python syntax highlighting
                    block.className = 'language-python';
                    hljs.highlightElement(block);
                    // Apply line numbers after highlighting
                    applyLineNumbers(block);
                }
            });

            panelsContainerEl.querySelectorAll(".view-reasoning-btn").forEach(btn => {
                btn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const encoded = btn.dataset.content || "";
                    if (!encoded) return;
                    const title = btn.dataset.title || "Reasoning";
                    showSeparateViewPanic(encoded, "reasoning", title);
                });
            });

            typesetMath();
            
            // Add event listeners for view separate buttons
            panelsContainerEl.querySelectorAll(".view-separate-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    e.preventDefault();
                    const content = btn.dataset.content;
                    const type = btn.dataset.type;
                    const title = btn.dataset.title;
                    showSeparateViewPanic(content, type, title);
                });
            });
        }

        // Doubt panels function
        function renderInteractivePanelsDoubt(problem, panelsContainerEl) {
            const model = problem && typeof problem === "object" ? problem.model : null;
            if (!model || typeof model !== "object") {
                panelsContainerEl.innerHTML = '<div class="empty-state">No model data available for this problem.</div>';
                typesetMath();
                return;
            }

            const modelName = model.name || "Model";
            const modelLink = model && typeof model === "object" ? (model.url || model.href || null) : null;
            const baseId = `${problem.id || "problem"}-${slugify(modelName)}`;
            const logoSrc = model.logo ? escapeAttribute(model.logo) : null;
            const modelHeading = modelLink
                ? `<a href="${escapeAttribute(modelLink)}" target="_blank" rel="noopener">${escapeHTML(modelName)}</a>`
                : escapeHTML(modelName);

            panelsContainerEl.innerHTML = `
                <div class="model-header">
                    ${logoSrc ? `<img src="${logoSrc}" alt="${escapeAttribute(modelName)} logo">` : ""}
                    <h2>${modelHeading}</h2>
                </div>
                <div class="model-panels">
                    ${["oracle", "interrupt"].map(stage => {
                        const stageData = model[stage] || {};
                        const stageLabel = stageData.label || (stage === "oracle" ? "Full Thinking" : "Info Update @0.3");
                        const bodyLabel = stage === "oracle" ? "Oracle Output" : "Update Output";
                        const renderedAnswer = stageData.answer ? renderRich(stageData.answer) : "";
                        const renderedFinal = stageData.final ? renderRich(stageData.final) : "";
                        const renderedReasoning = stageData.reasoning ? renderRich(stageData.reasoning) : "";
                        const codeLineCount = stageData.code ? countLines(stageData.code) : 0;
                        const answerLineCount = stageData.answer ? countLines(getContentString(stageData.answer)) : 0;
                        const codeLineLabel = codeLineCount > 0 ? `<p class="answer-line-count">Answer section: ${codeLineCount} LINES</p>` : "";
                        const answerLineLabel = answerLineCount > 0 ? `<p class="answer-line-count">Answer section: ${answerLineCount} LINES</p>` : "";
                        const reasoningSection = renderedReasoning ? `
                            <button class="view-reasoning-btn" data-content="${encodeURIComponent(renderedReasoning)}" data-title="Reasoning - ${stageLabel}">View reasoning</button>
                        ` : "";
                        const codeSection = stageData.code ? `
                            <div class="content-container">
                                ${codeLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(stageData.code)}" data-type="code" data-title="Code - ${stageLabel}">View separately</button>
                                <pre class="code-block"><code class="language-python">${escapeHTML(stageData.code)}</code></pre>
                            </div>` : "";
                        const answerSection = stageData.answer ? `
                            <div class="content-container">
                                ${answerLineLabel}
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedAnswer)}" data-type="math" data-title="Math Answer - ${stageLabel}">View separately</button>
                                <div class="math-answer">${renderedAnswer}</div>
                            </div>` : "";
                        const finalSection = stageData.final ? `
                            <div class="content-container">
                                <button class="view-separate-btn" data-content="${encodeURIComponent(renderedFinal)}" data-type="final" data-title="Final Answer - ${stageLabel}">View separately</button>
                                <div class="final-answer">${renderedFinal}</div>
                            </div>` : "";
                        return `
                            <section class="panel">
                                <h3>${bodyLabel} &mdash; ${stageLabel}</h3>
                                ${reasoningSection}
                                ${codeSection}
                                ${answerSection}
                                ${finalSection}
                            </section>
                        `;
                    }).join("")}
                </div>
            `;

            panelsContainerEl.querySelectorAll("pre code").forEach(block => {
                if (window.hljs) {
                    // Force Python syntax highlighting
                    block.className = 'language-python';
                    hljs.highlightElement(block);
                    // Apply line numbers after highlighting
                    applyLineNumbers(block);
                }
            });

            panelsContainerEl.querySelectorAll(".view-reasoning-btn").forEach(btn => {
                btn.addEventListener("click", (event) => {
                    event.preventDefault();
                    const encoded = btn.dataset.content || "";
                    if (!encoded) return;
                    const title = btn.dataset.title || "Reasoning";
                    showSeparateViewDoubt(encoded, "reasoning", title);
                });
            });

            typesetMath();
            
            // Add event listeners for view separate buttons
            panelsContainerEl.querySelectorAll(".view-separate-btn").forEach(btn => {
                btn.addEventListener("click", (e) => {
                    e.preventDefault();
                    const content = btn.dataset.content;
                    const type = btn.dataset.type;
                    const title = btn.dataset.title;
                    showSeparateViewDoubt(content, type, title);
                });
            });
        }

        function showSeparateView(content, type, title) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('separate-view-modal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'separate-view-modal';
                modal.className = 'interactive-viz modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <span class="modal-close">&times;</span>
                        <div class="modal-header">
                            <h2 id="modal-title"></h2>
                        </div>
                        <div id="modal-body"></div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                // Add close functionality
                modal.querySelector('.modal-close').addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                // Close modal when clicking outside
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            }
            
            // Set content
            document.getElementById('modal-title').textContent = title;
            const modalBody = document.getElementById('modal-body');
            
            if (type === 'code') {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = `<pre class="code-block"><code class="language-python">${escapeHTML(decodedContent)}</code></pre>`;
                // Apply syntax highlighting first, then line numbers
                modalBody.querySelectorAll("pre code").forEach(block => {
                    if (window.hljs) {
                        // Apply syntax highlighting first
                        block.className = 'language-python';
                        hljs.highlightElement(block);
                        // Then apply line numbers to the highlighted content
                        applyLineNumbers(block);
                    }
                });
            } else {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = decodedContent;
                typesetMath(modalBody);
            }
            modalBody.scrollTop = 0;
            
            // Show modal
            modal.style.display = 'block';
        }

        // Leakage modal function
        function showSeparateViewLeakage(content, type, title) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('separate-view-modal-leakage');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'separate-view-modal-leakage';
                modal.className = 'interactive-viz-leakage modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <span class="modal-close">&times;</span>
                        <div class="modal-header">
                            <h2 id="modal-title-leakage"></h2>
                        </div>
                        <div id="modal-body-leakage"></div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                // Add close functionality
                modal.querySelector('.modal-close').addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                // Close modal when clicking outside
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            }
            
            // Set content
            document.getElementById('modal-title-leakage').textContent = title;
            const modalBody = document.getElementById('modal-body-leakage');
            
            if (type === 'code') {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = `<pre class="code-block"><code class="language-python">${escapeHTML(decodedContent)}</code></pre>`;
                // Apply syntax highlighting first, then line numbers
                modalBody.querySelectorAll("pre code").forEach(block => {
                    if (window.hljs) {
                        // Apply syntax highlighting first
                        block.className = 'language-python';
                        hljs.highlightElement(block);
                        // Then apply line numbers to the highlighted content
                        applyLineNumbers(block);
                    }
                });
            } else {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = decodedContent;
                typesetMath(modalBody);
            }
            modalBody.scrollTop = 0;
            
            // Show modal
            modal.style.display = 'block';
        }

        // Panic modal function
        function showSeparateViewPanic(content, type, title) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('separate-view-modal-panic');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'separate-view-modal-panic';
                modal.className = 'interactive-viz-panic modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <span class="modal-close">&times;</span>
                        <div class="modal-header">
                            <h2 id="modal-title-panic"></h2>
                        </div>
                        <div id="modal-body-panic"></div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                // Add close functionality
                modal.querySelector('.modal-close').addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                // Close modal when clicking outside
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            }
            
            // Set content
            document.getElementById('modal-title-panic').textContent = title;
            const modalBody = document.getElementById('modal-body-panic');
            
            if (type === 'code') {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = `<pre class="code-block"><code class="language-python">${escapeHTML(decodedContent)}</code></pre>`;
                // Apply syntax highlighting first, then line numbers
                modalBody.querySelectorAll("pre code").forEach(block => {
                    if (window.hljs) {
                        // Apply syntax highlighting first
                        block.className = 'language-python';
                        hljs.highlightElement(block);
                        // Then apply line numbers to the highlighted content
                        applyLineNumbers(block);
                    }
                });
            } else {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = decodedContent;
                typesetMath(modalBody);
            }
            modalBody.scrollTop = 0;
            
            // Show modal
            modal.style.display = 'block';
        }

        // Doubt modal function
        function showSeparateViewDoubt(content, type, title) {
            // Create modal if it doesn't exist
            let modal = document.getElementById('separate-view-modal-doubt');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'separate-view-modal-doubt';
                modal.className = 'interactive-viz-doubt modal';
                modal.innerHTML = `
                    <div class="modal-content">
                        <span class="modal-close">&times;</span>
                        <div class="modal-header">
                            <h2 id="modal-title-doubt"></h2>
                        </div>
                        <div id="modal-body-doubt"></div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                // Add close functionality
                modal.querySelector('.modal-close').addEventListener('click', () => {
                    modal.style.display = 'none';
                });
                
                // Close modal when clicking outside
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.style.display = 'none';
                    }
                });
            }
            
            // Set content
            document.getElementById('modal-title-doubt').textContent = title;
            const modalBody = document.getElementById('modal-body-doubt');
            
            if (type === 'code') {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = `<pre class="code-block"><code class="language-python">${escapeHTML(decodedContent)}</code></pre>`;
                // Apply syntax highlighting first, then line numbers
                modalBody.querySelectorAll("pre code").forEach(block => {
                    if (window.hljs) {
                        // Apply syntax highlighting first
                        block.className = 'language-python';
                        hljs.highlightElement(block);
                        // Then apply line numbers to the highlighted content
                        applyLineNumbers(block);
                    }
                });
            } else {
                const decodedContent = decodeURIComponent(content);
                modalBody.innerHTML = decodedContent;
                typesetMath(modalBody);
            }
            modalBody.scrollTop = 0;
            
            // Show modal
            modal.style.display = 'block';
        }

        function applyLineNumbers(codeEl) {
            if (!codeEl || codeEl.dataset.lineNumbers === "true") {
                return;
            }

            const pre = codeEl.parentElement;
            if (!pre || !pre.classList.contains("code-block")) {
                return;
            }

            const rawText = (codeEl.textContent || "").replace(/\r\n/g, "\n");
            let totalLines = rawText.split("\n").length;

            if (rawText.endsWith("\n")) {
                totalLines -= 1;
            }

            if (totalLines < 1) {
                totalLines = 1;
            }

            const numbers = document.createElement("span");
            numbers.className = "line-numbers";
            numbers.setAttribute("aria-hidden", "true");

            const fragment = document.createDocumentFragment();
            for (let idx = 1; idx <= totalLines; idx += 1) {
                const marker = document.createElement("span");
                marker.textContent = idx;
                fragment.appendChild(marker);
            }

            numbers.appendChild(fragment);
            pre.insertBefore(numbers, codeEl);

            codeEl.dataset.lineNumbers = "true";
            pre.dataset.lineNumbers = "true";
        }

        function typesetMath(scope) {
            if (window.MathJax && window.MathJax.typesetPromise) {
                if (scope) {
                    MathJax.typesetPromise([scope]);
                } else {
                    MathJax.typesetPromise();
                }
            }
        }

        // Initialize interactive examples when page loads
        window.addEventListener("load", () => {
            typesetMath();
            loadInteractiveProblems();
            loadInteractiveProblemsLeakage();
            loadInteractiveProblemsPanic();
            loadInteractiveProblemsDoubt();
        });
    </script>

</body>

</html>
